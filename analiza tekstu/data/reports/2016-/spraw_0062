przedmiot TAS temat C nr_indeksu 384163 liczba_pkt 6 

\n\nZadanie\ 20\ -------------------------------------\n\nKody\ (Java):\ \n\nKlient:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef=\ HelloHelper.narrow(obj)\;\n\n\t\ \ \ \ System.out.println(\"podajLiczbe=\"+helloRef.podajLiczbe())\;\n\t\ \ \ \ System.out.println(\"sayHello=\"+helloRef.sayHello())\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\nSerwer:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\nimport\ org.omg.PortableServer.*\;\nimport\ org.omg.CosNaming.*\;\nimport\ org.omg.CosNaming.NamingContextPackage.*\;\n\nimport\ java.io.*\;\n\nclass\ HelloServant2\ extends\ HelloPOA\n\{\n\ \ \ \ private\ int\ licz\;\n\ \ \ \ private\ String\ str\;\n\ \ \ \ private\ ORB\ orb\;\n\n\ \ \ \ HelloServant2(ORB\ _orb)\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ super()\;\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2()\")\;\n\ \ \ \ \ \ \ \ licz=0\;\ str=\"\"\;\ orb=_orb\;\n\ \ \ \ \}\n\ \ \ \ public\ String\ sayHello()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"sayHello()\")\;\n\n\ \ \ \ \ \ \ \ //\ eksperyment\ z\ POA\n\ttry\ \{\n\ \ \ \ \ \ \ \ \ \ org.omg.PortableServer.Current\ poac=\ \n\t\ \ \ \ org.omg.PortableServer.CurrentHelper.narrow(\n\ \ \ \ \ \ \ \ \ \ \ \ \ \ orb.resolve_initial_references(\"POACurrent\"))\;\n\ \ \t\ \ byte\ b\[\]=\ poac.get_object_id()\;\n\ \ \ \ \ \ \ \ \ \n\t\ \ System.out.print(b.length+\":\ \")\;\n\ \ \ \ \ \ \ \ \ \ for(int\ i=0\;\ i<b.length\;\ i++)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.print(b\[i\]+\",\ \")\;\n\ \ \ \ \ \ \ \ \ \ \}\n\t\ \ System.out.println(\"\")\;\n\t\ \ \n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ System.err.println(\"sayHello()\;\ ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ \}\n\n\ \ \ \ \ \ \ \ return\ \"Hello\ world\ !!!\"\;\n\ \ \ \ \}\n\ \ \ \ public\ int\ podajLiczbe()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"podajLiczbe(),\ \"+licz)\;\n\ \ \ \ \ \ \ \ return\ licz++\;\n\ \ \ \ \}\n\ \ \ \ public\ String\ sayHello2(String\ we)\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ String\ s=\ we\ +\ \"\[\"\ +\ str+\ \"\]\"\;\n\ \ \ \ \ \ \ \ str=\ s\;\n\ \ \ \ \ \ \ \ return\ s\;\n\ \ \ \ \}\n\ \ \ \ public\ Hello\ sayHello_nowyObiekt()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ return\ null\;\n\ \ \ \ \}\n\ \ \ \ public\ void\ wektorRazy2(int\[\]\ tab1,\ HelloApp2.HelloPackage.tabHolder\ tab2)\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"wektorRazy2\ -\ poczatek\")\;\n\ \ \ \ \ \ \ \ tab2.value=\ new\ int\[10\]\;\n\ \ \ \ \ \ \ \ \ \ //\ !!!!!\ bez\ tego\ wystepowal\ dziwny\ blad\ corba\ !!!!\n\n\ \ \ \ \ \ \ \ for(int\ i=0\;\ i<10\;\ i++)\ tab2.value\[i\]=tab1\[i\]*2\;\n\ \ \ \ \ \ \ \ System.out.println(\"wektorRazy2\ -\ koniec\")\;\n\ \ \ \ \}\n\}\n\npublic\ class\ HelloServer2\ \{\n\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ servant\ and\ register\ it\ with\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ HelloServant2\ serv=\ new\ HelloServant2(orb)\;\n\t\ \ \ \ \n\t\ \ \ \ POA\ rootpoa=\ POAHelper.narrow(\n\t\ \ \ \ \ \ orb.resolve_initial_references(\"RootPOA\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ rootpoa.the_POAManager().activate()\;\t\ \ \ \ \ \ \n\t\ \ \ \ \n\t\ \ \ \ org.omg.CORBA.Object\ ref=\ rootpoa.servant_to_reference(serv)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=\ orb.object_to_string(ref)\;\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"IOR=\"+IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ PrintWriter\ out=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello.IOR\")))\;\n\ \ \ \ \ \ \ \ \ \ \ \ out.println(IOR)\;\ out.close()\;\n\n\t\ \ \ \ /*\n\t\ \ \ \ //\ get\ the\ root\ naming\ context\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ objRef\ =\n\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orb.resolve_initial_references(\"NameService\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ NamingContext\ ncRef\ =\ NamingContextHelper.narrow(objRef)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ bind\ the\ Object\ Reference\ in\ Naming\n\ \ \ \ \ \ \ \ \ \ \ \ NameComponent\ nc\ =\ new\ NameComponent(\"Hello2\",\ \"\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ NameComponent\ path\[\]\ =\ \{nc\}\;\n\ \ \ \ \ \ \ \ \ \ \ \ ncRef.rebind(path,\ serv)\;\n\ \ \ \ \ \ \ \ \ \ \ \ */\n\n\ \ \ \ \ \ \ \ \ \ \ \ /*\ //\ dlaczego\ to\ nie\ dziala\ ???\n\t\ \ \ \ String\ s\[\]=\ orb.list_initial_services()\;\n\t\ \ \ \ for(int\ i=0\;\ i<s.length\;\ i++)\ \{\n\t\ \ \ \ \ \ System.out.println(\"\"+i+\"-\ \"+s\[i\])\;\n\t\ \ \ \ \}*/\n\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"orb.run()\;\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ orb.run()\;\n\t\ \ \ \ \ \ \ \ System.out.println(\"orb.run()\;\ -\ koniec\")\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.err.println(\"ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\nKody\ (TCL):\n\nKlient:\n\n#kons_font\ 16\nlappend\ auto_path\ ./combat-tcl-0.7.4\;\ package\ re\ combat\n\ \ #%\ 0.7\n\nsource\ Hello3.tcl\ncombat::ir\ add\ \$_ir_Hello3\n\ \ #\ dodajemy\ wpis\ do\ (local)\ Interface\ Repository\n\nset\ f\ \[open\ \{Hello.IOR\}\ \"r\"\]\;\ set\ ior\ \[read\ \$f\]\;\ close\ \$f\n\ \ #\ tu\ powinna\ byc\ sciezka\ do\ pliku\ ior\ utworzonego\ przez\ serwer\ !!\n\nset\ m\ \[corba::string_to_object\ \$ior\]\n\ \ #\ mozna\ wywolywac\ metody\ na\ rzecz\ ob.\ Corby\ \$m\ ...\n\n\$m\ podajLiczbe\n\nSerwer:\n\nlappend\ auto_path\ ./combat-tcl-0.7.4\npackage\ require\ combat\n\nclass\ HelloWorld\ \{\n\ \ inherit\ PortableServer::ServantBase\n\ \ public\ method\ _Interface\ \{\}\ \{\n\ \ \ \ return\ \"IDL:HelloApp2/Hello:1.0\"\n\ \ \ \ \ \ #\ tzw\ \"RepoID\"\;\ mozna\ to\ wyciagnac\ z\ pliku\ Hello3.tcl\n\ \ \}\n\n\ \ #\ w\ pliku\ IDL\ mamy:\n\ \ #\ \ \ string\ sayHello()\;\n\ \ #\ \ \ string\ sayHello2(in\ string\ we)\;\n\ \ #\ \ \ long\ podajLiczbe()\;\n\ \ #\ \ \ Hello\ sayHello_nowyObiekt()\;\n\ \ #\ \ \ typedef\ long\ tab\[10\]\;\n\ \ #\ \ \ void\ wektorRazy2(in\ tab\ tab1,\ out\ tab\ tab2)\;\n\ \ #\ \ \ void\ uruchomZwrotnaMet(in\ WywZwrotne\ ref)\;\n\ \ #\n\ \ public\ method\ sayHello\ \{\}\ \{\n\ \ \ \ return\ \"Jak\ sie\ masz\ ???\"\n\ \ \}\n\n\ \ public\ method\ sayHello2\ \{_str\}\ \{\n\ \ \ \ set\ str\ \"\$str\ \$_str\"\n\ \ \ \ return\ \"sayHello2:\ str=\$str\"\n\ \ \}\n\n\ \ public\ method\ podajLiczbe\ \{\}\ \{\n\ \ \ \ set\ x\ \$liczba\;\ incr\ liczba\n\ \ \ \ return\ \$x\n\ \ \}\n\n\ \ #\ ta\ metoda\ tworzy\ nowy\ obiekt\ HelloWorld\ i\ zwraca\ ref\ do\ tego\ obiektu\n\ \ public\ method\ sayHello_nowyObiekt\ \{\}\ \{\n\ \ \ \ global\ poa\n\ \ \ \ puts\ \"poczatek\ sayHello_nowyObiekt\"\n\ \ \ \ puts\ \"poa=\$poa\"\n\n\ \ \ \ set\ obj\ \[HelloWorld\ ::#auto\]\n\ \ \ \ \ \ #\ nowy\ obiekt\ (servant)\ jest\ tworzony\ w\ namespace\ globalnym\n\ \ \ \ \ \ #\ \"#auto\"\ to\ automatyczne\ nadawanie\ nazwy\ obiektowi\n\ \ \ \ puts\ \"obj=\$obj\"\n\n\ \ \ \ set\ ref\ \[\$poa\ servant_to_reference\ \$obj\]\n\ \ \ \ puts\ \"ref=\$ref\"\n\n\ \ \ \ puts\ \"koniec\ sayHello_nowyObiekt\"\n\ \ \ \ return\ \$ref\n\ \ \}\n\n\ \ public\ method\ wektorRazy2\ \{tab1\ tab2\}\ \{\n\ \ \ \ puts\ \"wektorRazy2\ poczatek\"\n\ \ \ \ upvar\ \$tab2\ tab2_value\n\ \ \ \ \ \ #\ obsluga\ arg.\ typu\ \"out\"\ (zwracanie\ \"przez\ zmienna\"\ w\ Pascalu)\n\n\ \ \ \ set\ tab2_value\ \{\}\n\ \ \ \ foreach\ x\ \$tab1\ \{lappend\ tab2_value\ \[expr\ \$x*2\]\}\n\n\ \ \ \ puts\ \"wektorRazy2\ koniec\"\n\ \ \}\n\n\ \ public\ method\ uruchomZwrotnaMet\ ref\ \{\n\ \ \ \ for\ \{set\ i\ 0\}\ \{\$i<5\}\ \{incr\ i\}\ \{\n\ \ \ \ \ \ \$ref\ metoda\n\ \ \ \ \}\n\ \ \}\n\n\ \ private\ variable\ str\ \"\"\n\ \ private\ variable\ liczba\ 0\n\}\n\ncorba::init\n\nsource\ Hello3.tcl\ncombat::ir\ add\ \$_ir_Hello3\n\nset\ obj\ \[HelloWorld\ #auto\]\nputs\ \"obj=\$obj\"\n\n###\ POA\ -------------------------------------------------------\n\nset\ poa\ \[corba::resolve_initial_references\ \"RootPOA\"\]\nset\ mgr\ \[\$poa\ the_POAManager\]\nputs\ \"poa=\$poa\"\n\n#set\ mypoa\ \[\$poa\ create_POA\ MyPOA\ \$mgr\ \{RETAIN\ USER_ID\}\]\n#set\ oid\ \[\$poa\ activate_object\ \$obj\]\n#set\ ref\ \[\$poa\ id_to_reference\ \$oid\]\n\nset\ ref\ \[\$poa\ servant_to_reference\ \$obj\]\nputs\ \"ref=\$ref\"\n\nset\ ior\ \[corba::object_to_string\ \$ref\]\nset\ f\ \[open\ \{Hello.IOR\}\ \"w\"\]\;\ puts\ \$f\ \$ior\;\ close\ \$f\nputs\ \"HelloWorld\ IOR\ =\ \$ior\"\n\n\nWydruki:\n\nJava\ -\ Java\n\nSerwer:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/Hello_Java\$\ java\ HelloServer2\ \nHelloServant2()\nIOR=IOR:0000000000000321312dsac48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000082000102000000000a3132372e302e302e310097e800000031afabcb00000000206b6e2f9100000001000000000000000100000008526f6f74504f410000000008000000010000000014000000000000020000000100000020000000000001000100000002050100010001002000010109000000010001010000000026000000020002\norb.run()\;\npodajLiczbe(),\ 0\nsayHello()\n8:\ 0,\ 0,\ 0,\ 1,\ 0,\ 0,\ 0,\ 0,\ \npodajLiczbe(),\ 2\nsayHello()\n8:\ 0,\ 0,\ 0,\ 1,\ 0,\ 0,\ 0,\ 0,\ \n\nKlient:\n\njava\ HelloClient2\ \npodajLiczbe=0\nsayHello=Hello\ world\ !!!\n\njava\ HelloClient2\ \npodajLiczbe=1\nsayHello=Hello\ world\ !!!\ \ \n\nJava\ -\ TCL\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/Hello_Java\$\ java\ HelloServer2\ \nHelloServant2()\nIOR=IOR:000000000000001849444c3a43213123c8656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000082000102000000000a3132372e302e302e310097e800000031a\n\nfabcb00000000206b6e2f9100000001000000000000000100000008526f6f74504f410000000008000000010000000014000000000000020000000100000020000000000001000100\n\n000002050100010001002000010109000000010001010000000026000000020002\norb.run()\;\npodajLiczbe(),\ 0\npodajLiczbe(),\ 1\npodajLiczbe(),\ 2\npodajLiczbe(),\ 3\npodajLiczbe(),\ 4\n\nKlient:\n\n\$m\ podajLiczbe\n%4\n%3\n%2\n%1\n%0\n\nTCL\ -\ TCL\n\n\$m\ podajLiczbe\n%5\n%4\n%3\n%2\n%1\n%0\n\nZadanie\ 21\ -------------------------------------\n\na)\nKody:\n\nKlient\ (Java):\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef=\ HelloHelper.narrow(obj)\;\n\n\t\ \ \ \ System.out.println(\"podajLiczbe=\"+helloRef.podajLiczbe())\;\n\t\ \ \ \ System.out.println(\"sayHello=\"+helloRef.sayHello())\;\n\t\ \ \ \ \n\t\tHello\ nowyObiekt\ =\ helloRef.sayHello_nowyObiekt()\;\n\t\t\n\t\tSystem.out.println(\"Nowy\ obiekt:\"\ +\ nowyObiekt.podajLiczbe()\ )\;\n\t\tSystem.out.println(\"Nowy\ obiekt:\"\ +\ nowyObiekt.podajLiczbe()\ )\;\n\t\tSystem.out.println(\"Nowy\ obiekt:\"\ +\ nowyObiekt.podajLiczbe()\ )\;\n\t\tSystem.out.println(\"Nowy\ obiekt:\"\ +\ nowyObiekt.podajLiczbe()\ )\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\nSerwer:\n\n\ \ \ \ \ \ \ \ super()\;\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2()\")\;\n\ \ \ \ \ \ \ \ licz=0\;\ str=\"\"\;\ orb=_orb\;\n\t\tif\ (\ createSon\ )\ \{\n\t\t\torg.omg.CORBA.Object\ ref\ =\ null\;\n\t\t\ttry\ \{\n\t\t\t\t\tHelloServant2\ serv=\ new\ HelloServant2(orb,\ false)\;\n\t\t\t\n\t\t\t\tPOA\ rootpoa=\ POAHelper.narrow(\n\t\t\t\t\torb.resolve_initial_references(\"RootPOA\"))\;\n\t\t\t\tref\ =\ rootpoa.servant_to_reference(serv)\;\n\t\t\t\}\ catch(\ Exception\ e\ )\ \{\}\;\ \ \n\t\t\tsyn\ =\ HelloHelper.narrow(ref)\;\n\t\t\}\n\t\telse\n\t\t\{\n\t\t\tsyn\ =\ null\;\n\t\t\}\ \ \ \ \ \ \ \ super()\;\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2()\")\;\n\ \ \ \ \ \ \ \ licz=0\;\ str=\"\"\;\ orb=_orb\;\n\t\tif\ (\ createSon\ )\ \{\n\t\t\torg.omg.CORBA.Object\ ref\ =\ null\;\n\t\t\ttry\ \{\n\t\t\t\t\tHelloServant2\ serv=\ new\ HelloServant2(orb,\ false)\;\n\t\t\t\n\t\t\t\tPOA\ rootpoa=\ POAHelper.narrow(\n\t\t\t\t\torb.resolve_initial_references(\"RootPOA\"))\;\n\t\t\t\tref\ =\ rootpoa.servant_to_reference(serv)\;\n\t\t\t\}\ catch(\ Exception\ e\ )\ \{\}\;\ \ \n\t\t\tsyn\ =\ HelloHelper.narrow(ref)\;\n\t\t\}\n\t\telse\n\t\t\{\n\t\t\tsyn\ =\ null\;\n\t\t\}\n\n\ \ \ \ public\ Hello\ sayHello_nowyObiekt()\n\ \ \ \ \{\n\t\treturn\ syn\;\n\ \ \ \ \}\n\n\nWydruki:\n\nSerwer:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/21/Java>java\ HelloServer2\nHelloServant2()\nHelloServant2()\nIOR=IOR:00000000000000184fdsfsd34234326f417070322f48656c6c6f3a312e3000000000010000000000000086000102000000000e3135302e\n3235342e37382e3234008fb200000031afabcb0000000020fe18ba5300000001000000000000000100000008526f6f74504f41000000000800000002\n000000001400000000000002000000010000002000000000000100010000000205010001000100200001010900000001000101000000002600000002\n0002\norb.run()\;\npodajLiczbe(),\ 0\nsayHello()\n8:\ 0,\ 0,\ 0,\ 2,\ 0,\ 0,\ 0,\ 0,\npodajLiczbe(),\ 0\npodajLiczbe(),\ 1\npodajLiczbe(),\ 2\npodajLiczbe(),\ 3\n\nKlient:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/21/Java>java\ HelloClient2\npodajLiczbe=0\nsayHello=Hello\ world\ !!!\n\nNowy\ obiekt:0\nNowy\ obiekt:1\nNowy\ obiekt:2\nNowy\ obiekt:3\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/21/Java>java\ HelloClient2\npodajLiczbe=1\nsayHello=Hello\ world\ !!!\nNowy\ obiekt:4\nNowy\ obiekt:5\nNowy\ obiekt:6\nNowy\ obiekt:7\n\n\nb)\nSerwer:\n\n\ \ \ \ public\ String\ sayHello()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"sayHello()\")\;\n\t\t\n\t\tint\ myCnt\ =\ ++cntSayHello\;\n\t\ttry\ \{\n\t\t\t//\ eksperyment\ z\ POA\n\t\t\tfor(\ int\ i\ =\ 0\;\ i\ <\ 10\;\ i++\ )\n\t\t\t\{\n\t\t\t\tSystem.err.println(\"Moj\ cnt:\ \"\ +\ myCnt\ )\;\n\t\t\t\tThread.sleep(1000)\;\ \n\t\t\t\}\n\t\t\t\n\t\t\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ System.err.println(\"sayHello()\;\ ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ \}\n\n\ \ \ \ \ \ \ \ return\ \"Hello\ world\ !!!\"\;\n\ \ \ \ \}\n\t\nKlient:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef=\ HelloHelper.narrow(obj)\;\n\n\t\ \ \ \ System.out.println(\"sayHello=\"+helloRef.sayHello())\;\n\t\ \ \ \ \n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\n\nWydruki:\n\nSerwer:\n\nHelloServant2()\nIOR=IOR:000000000000001e31231417070322f48656c6c6f3a312e3000000000010000000000000086000102000000000e3135302e\n3235342e37382e323400905300000031afabcb0000000020fe24af9400000001000000000000000100000008526f6f74504f41000000000800000001\n000000001400000000000002000000010000002000000000000100010000000205010001000100200001010900000001000101000000002600000002\n0002\norb.run()\;\nsayHello()\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nMoj\ cnt:\ 1\nsayHello()\nMoj\ cnt:\ 2\nMoj\ cnt:\ 2\nMoj\ cnt:\ 2\nMoj\ cnt:\ 2\nMoj\ cnt:\ 2\nMoj\ cnt:\ 2\nsayHello()\nMoj\ cnt:\ 3\nMoj\ cnt:\ 2\nMoj\ cnt:\ 3\nMoj\ cnt:\ 2\nMoj\ cnt:\ 3\nMoj\ cnt:\ 2\nMoj\ cnt:\ 3\nMoj\ cnt:\ 2\nMoj\ cnt:\ 3\nMoj\ cnt:\ 3\nMoj\ cnt:\ 3\nMoj\ cnt:\ 3\nMoj\ cnt:\ 3\nMoj\ cnt:\ 3\n\nCorba\ dzia³a\ na\ wielu\ w±tkach.\n\nc)\n\nSerwer:\n\npublic\ String\ sayHello()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"sayHello()\")\;\n\t\ttry\ \{\n\t\tBufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello_2.IOR\"))\;\n\t\tString\ IOR=in.readLine()\;\ in.close()\;\n\t\torg.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\t\tHello\ helloRef=\ HelloHelper.narrow(obj)\;\n\t\t\n\ \ \ \ \ \ \ \ System.out.println(\"Zdalny\ obiekt,\ \"+\ helloRef.sayHello2(\"Serwer\"))\;\n\t\t\n\t\t\}\ catch(\ Exception\ e\ )\ \{\ \ System.out.println(\ \"ERROR\"\ )\;\ \}\;\n\n\ \ \ \ \ \ \ \ return\ \"Hello\ world\ !!!\"\;\n\ \ \ \ \}\n\nKlient:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\nimport\ org.omg.PortableServer.*\;\nimport\ org.omg.CosNaming.*\;\nimport\ org.omg.CosNaming.NamingContextPackage.*\;\n\nclass\ DDDD\ implements\ Runnable\{\n\t\n\tORB\ orb\;\n\n\tpublic\ DDDD(\ ORB\ _orb\ )\ \{\n\t\torb\ =\ _orb\;\n\ \ \ \ \}\n\n\tpublic\ void\ run()\ \{\n\t\ttry\ \{\n\t\t//\ create\ servant\ and\ register\ it\ with\ the\ ORB\n\t\tHelloServant2\ serv=\ new\ HelloServant2(orb,\ true)\;\n\t\ \ \ \ \n\t\ \ \ \ POA\ rootpoa=\ POAHelper.narrow(\n\t\ \ \ \ \ \ orb.resolve_initial_references(\"RootPOA\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ rootpoa.the_POAManager().activate()\;\t\ \ \ \ \ \ \n\t\ \ \ \ \n\t\ \ \ \ org.omg.CORBA.Object\ ref=\ rootpoa.servant_to_reference(serv)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=\ orb.object_to_string(ref)\;\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"IOR=\"+IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ PrintWriter\ out=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello_2.IOR\")))\;\n\ \ \ \ \ \ \ \ \ \ \ \ out.println(IOR)\;\ out.close()\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"orb.run()\;\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ orb.run()\;\n\t\ \ \ \ System.out.println(\"orb.run()\;\ -\ koniec\")\;\n\t\t\}\ catch(\ Exception\ e\ )\ \{\}\;\n\t\}\n\}\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\t\t\tnew\ Thread(new\ DDDD(orb)).start(\ \ )\;\n\t\t\t\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef=\ HelloHelper.narrow(obj)\;\n\n\t\ \ \ \ \ \ \ \ System.out.println(\"sayHello=\"+helloRef.sayHello())\;\n\t\ \ \ \ \n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\n\nWydruki:\n\nHelloServant2()\nHelloServant2()\nIOR=IOR:000000000000001849444c3a48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000086000102000000000e3135302e\n3235342e37382e323400926400000031afabcb0000000020fe40d5fb00000001000000000000000100000008526f6f74504f41000000000800000002\n000000001400000000000002000000010000002000000000000100010000000205010001000100200001010900000001000101000000002600000002\n0002\norb.run()\;\nSayHello2\nsayHello=Hello\ world\ !!!\nSerwer:\nHelloServant2()\nHelloServant2()\nIOR=IOR:000000000000001849444c3a48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000086000102000000000e3135302e\n3235342e37382e323400926100000031afabcb0000000020fe40c77f00000001000000000000000100000008526f6f74504f41000000000800000002\n000000001400000000000002000000010000002000000000000100010000000205010001000100200001010900000001000101000000002600000002\n0002\norb.run()\;\nsayHello()\nZdalny\ obiekt,\ Serwer\[\]\n\n\nMetodê\ da\ siê\ wywo³aæ\ zdalnie\ (SayHello2)\ na\ kliencie\ z\ serwera.\n\nZadanie\ 22\ -------------------------------------\na),\ b)\n\nSerwer:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\nimport\ org.omg.PortableServer.*\;\nimport\ org.omg.CosNaming.*\;\nimport\ org.omg.CosNaming.NamingContextPackage.*\;\n\nimport\ java.io.*\;\n\nclass\ HelloServant2\ extends\ HelloPOA\n\{\n\ \ \ \ private\ ORB\ orb\;\n\n\ \ \ \ HelloServant2(ORB\ _orb)\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ super()\;\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2()\")\;\n\t\torb\ =_orb\;\n\ \ \ \ \}\n\tpublic\ void\ pomnoz\ (int\[\]\ v_in,\ int\ num,\ HelloApp2.HelloPackage.vectorHolder\ v_out)\n\t\{\n\ \ \ \ \ \ \ \ System.out.println(\"pomnoz\ -\ poczatek\")\;\n\ \ \ \ \ \ \ \ v_out.value\ =\ new\ int\[v_in.length\]\;\n\n\ \ \ \ \ \ \ \ for(int\ i=0\;\ i<v_in.length\;\ i++)\ v_out.value\[i\]\ =\ v_in\[i\]\ *\ num\;\n\ \ \ \ \ \ \ \ System.out.println(\"pomnoz\ -\ koniec\")\;\n\t\}\n\tpublic\ void\ pomnoz10\ (int\[\]\ t_in,\ int\ num,\ HelloApp2.HelloPackage.tabHolder\ t_out)\n\t\{\n\ \ \ \ \ \ \ \ System.out.println(\"pomnoz10\ -\ poczatek\")\;\n\ \ \ \ \ \ \ \ t_out.value\ =\ new\ int\[t_in.length\]\;\n\n\ \ \ \ \ \ \ \ for(int\ i=0\;\ i<t_in.length\;\ i++)\ t_out.value\[i\]\ =\ t_in\[i\]\ *\ num\;\n\ \ \ \ \ \ \ \ System.out.println(\"pomnoz10\ -\ koniec\")\;\n\t\}\n\tpublic\ int\ sumaElementow\ (int\[\]\[\]\ mat)\n\t\{\n\ \ \ \ \ \ \ \ System.out.println(\"sumaElementow\ -\ poczatek\")\;\n\t\tint\ wiersze\ =\ mat.length\;\n\t\tint\ kolumny\ =\ mat\[0\].length\;\n\n\t\tint\ res\ =\ 0\;\n\ \ \ \ \ \ \ \ for(int\ i=0\;\ i<wiersze\;\ i++)\n\t\t\tfor(int\ j=0\;\ j<kolumny\;\ j++)\n\t\t\t\tres\ +=\ mat\[i\]\[j\]\;\n\ \ \ \ \ \ \ \ System.out.println(\"sumaElementow\ -\ koniec\")\;\n\t\treturn\ res\;\n\t\}\n\}\n\npublic\ class\ HelloServer2\ \{\n\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ servant\ and\ register\ it\ with\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ HelloServant2\ serv=\ new\ HelloServant2(orb)\;\n\t\ \ \ \ \n\t\t\tPOA\ rootpoa=\ POAHelper.narrow(\n\t\t\torb.resolve_initial_references(\"RootPOA\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ rootpoa.the_POAManager().activate()\;\t\ \ \ \ \ \ \n\t\ \ \ \ \n\t\t\torg.omg.CORBA.Object\ ref=\ rootpoa.servant_to_reference(serv)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=\ orb.object_to_string(ref)\;\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"IOR=\"+IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ PrintWriter\ out=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello.IOR\")))\;\n\ \ \ \ \ \ \ \ \ \ \ \ out.println(IOR)\;\ out.close()\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"orb.run()\;\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ orb.run()\;\n\t\t\tSystem.out.println(\"orb.run()\;\ -\ koniec\")\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.err.println(\"ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\nSerwer:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj=\ orb.string_to_object(IOR)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef=\ HelloHelper.narrow(obj)\;\n\n\t\t\tint\[\]\ v_in\ =\ new\ int\[\]\ \{1,2,3,4,5,6,7,8,9,10,11\}\;\n\t\t\tHelloApp2.HelloPackage.vectorHolder\ v_out\ =\ new\ HelloApp2.HelloPackage.vectorHolder()\;\n\t\t\thelloRef.pomnoz(v_in,\ 3,\ v_out)\;\n\t\t\tSystem.out.print(\"pomnoz=\{\")\;\n\t\t\tfor\ (int\ i=0\;\ i<v_out.value.length\;\ i++)\ System.out.print(v_out.value\[i\]\ +\ \",\")\;\n\t\t\tSystem.out.println(\"\}\")\;\n\t\t\t\n\t\t\tint\[\]\ t_in\ =\ new\ int\[\]\ \{1,2,3,4,5,6,7,8,9,10\}\;\n\t\t\t//\ jezeli\ rozmiar\ tablicy\ nie\ jest\ 10,\ nast±pi\ rzucenie\ wyj±tku.\n\t\t\tHelloApp2.HelloPackage.tabHolder\ t_out\ =\ new\ HelloApp2.HelloPackage.tabHolder()\;\n\t\t\thelloRef.pomnoz10(t_in,\ 3,\ t_out)\;\n\t\t\tSystem.out.print(\"pomnoz10=\{\")\;\n\t\t\tfor\ (int\ i=0\;\ i<t_out.value.length\;\ i++)\ System.out.print(t_out.value\[i\]\ +\ \",\")\;\n\t\t\tSystem.out.println(\"\}\")\;\n\t\t\t\n\t\t\tint\[\]\[\]\ mat\ =\ new\ int\[\]\[\]\ \{\n\t\t\t\t\{\ 1,\ \ 2,\ \ 3,\ 4\},\n\t\t\t\t\{\ 1,\ \ 2,\ \ 3,\ 4\},\n\t\t\t\t\{\ 1,\ \ 2,\ \ 3,\ 4\}\n\t\t\t\}\;\n\t\t\tSystem.out.println(\"sumaElementow=\"\ +\ helloRef.sumaElementow(mat))\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\n\nWydruki:\n\nSerwer:\n\nHelloServant2()\nIOR=IOR:000000000000001849444c3a48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000086000102000000000e3135302e\n3235342e37382e323400944800000031afabcb0000000020fe5928c600000001000000000000000100000008526f6f74504f41000000000800000001\n000000001400000000000002000000010000002000000000000100010000000205010001000100200001010900000001000101000000002600000002\n0002\norb.run()\;\npomnoz\ -\ poczatek\npomnoz\ -\ koniec\npomnoz10\ -\ poczatek\npomnoz10\ -\ koniec\nsumaElementow\ -\ poczatek\nsumaElementow\ -\ koniec\n\nKlient:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/22>java\ HelloClient2\npomnoz=\{3,6,9,12,15,18,21,24,27,30,33,\}\npomnoz10=\{3,6,9,12,15,18,21,24,27,30,\}\nsumaElementow=30\n\nZadanie\ 23\ -------------------------------------\n\nKlient:\n\nimport\ HelloApp2.*\;\n\nimport\ org.omg.CORBA.*\;\n\nimport\ java.io.*\;\n\npublic\ class\ HelloClient2\n\{\n\ \ \ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ \ \ \ \ //\ dostep\ do\ obiektu\ przez\ IOR\n\ \ \ \ \ \ \ \ \ \ \ \ BufferedReader\ in=\ new\ BufferedReader(new\ FileReader(\"Hello_A.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR_A=in.readLine()\;\ in.close()\;\n\ \ \ \ \ \ \ \ \ \ \ \ in=\ new\ BufferedReader(new\ FileReader(\"Hello_B.IOR\"))\;\n\ \ \ \ \ \ \ \ \ \ \ \ String\ IOR_B=in.readLine()\;\ in.close()\;\n\t\t\t\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj_A=\ orb.string_to_object(IOR_A)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef_A=\ HelloHelper.narrow(obj_A)\;\n\ \ \ \ \ \ \ \ \ \ \ \ org.omg.CORBA.Object\ obj_B=\ orb.string_to_object(IOR_B)\;\n\ \ \ \ \ \ \ \ \ \ \ \ Hello\ helloRef_B=\ HelloHelper.narrow(obj_B)\;\n\n\t\t\tSystem.out.println(\"A:sayHello=\"+helloRef_A.sayHello())\;\n\t\t\tSystem.out.println(\"A:podajLiczbe=\"+helloRef_A.podajLiczbe())\;\n\t\t\tSystem.out.println(\"B:sayHello=\"+helloRef_B.sayHello())\;\n\t\t\tSystem.out.println(\"B:podajLiczbe=\"+helloRef_B.podajLiczbe())\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\}\n\nSerwer:\n\nFunkcja\ SayHello\n\ \ \ \ public\ String\ sayHello()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"sayHello()\")\;\n\n\ \ \ \ \ \ \ \ //\ eksperyment\ z\ POA\n\t\ttry\ \{\n\t\t\torg.omg.PortableServer.Current\ poac=\ \n\t\t\torg.omg.PortableServer.CurrentHelper.narrow(\n\t\t\torb.resolve_initial_references(\"POACurrent\"))\;\n\t\t\tbyte\ b\[\]=\ poac.get_object_id()\;\n\n\t\t\tSystem.out.println(\"oid:\ \"\ +\ new\ String(b,\ \"UTF-8\"))\;\n\t\ \ \n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\t\t\tSystem.err.println(\"sayHello()\;\ ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ \}\n\n\ \ \ \ \ \ \ \ return\ \"Hello\ world\ !!!\"\;\n\ \ \ \ \}\n\t\nmain:\n\t//\ ustawiamy\ polityki\ USER_ID\ i\ MULTIPLE_ID\n\torg.omg.CORBA.Policy\[\]\ policies\ =\ new\ org.omg.CORBA.Policy\[2\]\;\n\tpolicies\[0\]\ =\ rootpoa.create_id_assignment_policy(\n\t\tIdAssignmentPolicyValue.USER_ID\ )\;\n\tpolicies\[1\]\ =\ rootpoa.create_id_uniqueness_policy(\n\t\tIdUniquenessPolicyValue.MULTIPLE_ID)\;\n\tPOA\ myPOA\ =\ rootpoa.create_POA(\"MyPOA\",\ null,\ policies)\;\n\t\n\tmyPOA.the_POAManager().activate()\;\n\t\n\t//\ tworzymy\ oid\ dla\ obiektow\ A\ i\ B\n\tbyte\[\]\ oid_A\ =\ new\ String(\"HelloWorld_A\").getBytes()\;\n\tbyte\[\]\ oid_B\ =\ new\ String(\"HelloWorld_B\").getBytes()\;\n\t\n\tmyPOA.activate_object_with_id(oid_A,\ serv)\;\n\tmyPOA.activate_object_with_id(oid_B,\ serv)\;\n\t\n\t//\ pobieramy\ referencje\ do\ obiektow\n\torg.omg.CORBA.Object\ ref_A\ =\ myPOA.id_to_reference(oid_A)\;\n\torg.omg.CORBA.Object\ ref_B\ =\ myPOA.id_to_reference(oid_B)\;\n\n\t//\ zapisujemy\ OIR\ obiektow\ A\ i\ B\ do\ plikow\n\tString\ IOR_A\ =\ orb.object_to_string(ref_A)\;\n\tSystem.out.println(\"IOR_A=\"+IOR_A)\;\n\tPrintWriter\ out=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello_A.IOR\")))\;\n\tout.println(IOR_A)\;\ out.close()\;\n\t\n\tString\ IOR_B\ =\ orb.object_to_string(ref_B)\;\n\tSystem.out.println(\"IOR_B=\"+IOR_B)\;\n\tout=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello_B.IOR\")))\;\n\tout.println(IOR_B)\;\ out.close()\;\n\n-------------------------------------\n2\ obiekty\ Corba\ korzystaj±\ z\ jednego\ serwanta.\n\nZadanie\ 24\ -------------------------------------\n\nSerwer:\n\nSerwant\ Manager:\nclass\ MySM\ extends\ LocalObject\ implements\ ServantActivator\n\{\n\ \ \ \ private\ ORB\ orb\;\n\tprivate\ POA\ poa\;\n\n\ \ \ \ MySM(ORB\ _orb,\ POA\ _poa)\n\t\{\n\t\tsuper()\;\n\ \ \ \ \ \ \ \ System.out.println(\"MySM()\")\;\n\t\torb\ =\ _orb\;\ poa\ =\ _poa\;\n\t\}\n\t\n\ \ \ \ public\ Servant\ incarnate(byte\[\]\ oid,\ POA\ adapter)\ throws\ ForwardRequest\n\t\{\n\ \ \ \ \ \ \ \ try\ \{\n\t\t\t//\ tworzymy\ servanta\n\ \ \ \ \ \ \ \ \ \ \ \ HelloServant2\ serv\ =\ new\ HelloServant2(orb,\ poa,\ oid)\;\n\ \ \ \ \ \ \ \ \ \ \ \ System.out.print(\"SM:\ incarnate(oid=\{\")\;\n\t\t\tfor\ (int\ i=0\;\ i<oid.length\;\ i++)\ System.out.print(oid\[i\]+\",\")\;\n\t\t\tSystem.out.println(\"\},\ poa='\"\ +\ adapter.the_name()\ +\ \"')\")\;\n\ \ \ \ \ \ \ \ \ \ \ \ return\ serv\;\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ System.err.println(\"SM:\ ERROR\")\;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \ \ \ \ return\ null\;\n\ \ \ \ \}\n\n\ \ \ \ public\ void\ etherealize(byte\[\]\ oid,\ POA\ adapter,\ Servant\ serv,\n\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boolean\ cleanup_in_progress,\n\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boolean\ remaining_activations)\n\t\{\n\t\tSystem.out.print(\"SM:\ etherealize(oid=\{\")\;\n\t\tfor\ (int\ i=0\;\ i<oid.length\;\ i++)\ System.out.print(oid\[i\]+\",\")\;\n\t\tSystem.out.println(\"\},\ poa='\"\ +\ adapter.the_name()\ +\ \"')\")\;\n\ \ \ \ \}\n\}\n\nKlasa\ Servant:\nclass\ HelloServant2\ extends\ HelloPOA\n\{\n\ \ \ \ private\ ORB\ orb\;\n\tprivate\ POA\ poa\;\n\tbyte\[\]\ oid\;\n\n\ \ \ \ HelloServant2(ORB\ _orb,\ POA\ _poa,\ byte\[\]\ _oid)\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ super()\;\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2:\ constructor\")\;\n\ \ \ \ \ \ \ \ orb=_orb\;\ poa\ =\ _poa\;\ oid\ =\ _oid\;\n\ \ \ \ \}\n\tprotected\ void\ finalize()\n\t\{\n\ \ \ \ \ \ \ \ System.out.println(\"HelloServant2:\ destructor\ (finalize)\")\;\n\t\}\n\ \ \ \ public\ String\ sayHello()\n\ \ \ \ \{\n\ \ \ \ \ \ \ \ System.out.println(\"sayHello()\")\;\n\ \ \ \ \ \ \ \ return\ \"Jak\ sie\ masz\ ???\"\;\n\ \ \ \ \}\n\ \ \ \ public\ void\ deactivate()\n\ \ \ \ \{\n\t\ttry\ \{\n\t\t\tSystem.out.println(\"deactivate()\")\;\n\t\t\tpoa.deactivate_object(oid)\;\n\t\t\}\ catch\ (Exception\ e)\ \{\}\n\ \ \ \ \}\n\}\nDodawanie\ polityk:\n//\ ustawiamy\ polityke\ USE_SERVANT_MANAGER\norg.omg.CORBA.Policy\[\]\ policies\ =\ new\ org.omg.CORBA.Policy\[\]\ \{\n\trootpoa.create_request_processing_policy(\n\t\ \ RequestProcessingPolicyValue.USE_SERVANT_MANAGER)\n\}\;\nPOA\ mypoa\ =\ rootpoa.create_POA(\"MyPOA\",\ null,\ policies)\;\nmypoa.the_POAManager().activate()\;\n\n//\ rejestrujemy\ wlasny\ servant\ manager\nmypoa.set_servant_manager(new\ MySM(orb,\ mypoa))\;\n\n//\ tworzymy\ referencje\ do\ obiektu\ CORBA\ bez\ aktywowania\ go\norg.omg.CORBA.Object\ ref=\ mypoa.create_reference(\"IDL:HelloApp2/Hello:1.0\")\;\nSystem.out.println(\"ref=\"\ +\ ref)\;\n\nString\ IOR=\ orb.object_to_string(ref)\;\nSystem.out.println(\"IOR=\"+IOR)\;\nPrintWriter\ out=\ new\ PrintWriter(new\ BufferedWriter(new\ FileWriter(\"Hello.IOR\")))\;\n\n\n\nKlient:\n\nKlient\ posiada\ standardowy\ kod:\n...\ metody\ zdalne...\nSystem.out.println(\"sayHello=\"+helloRef.sayHello())\;\nSystem.out.println(\"deactivate\")\;\ helloRef.deactivate()\;\nSystem.out.println(\"sayHello=\"+helloRef.sayHello())\;\n\n\nWydruki:\n\nSerwer:\n\nref=IOR:000000000000001849444c3a48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000092000102000000000e3135302e\n3235342e37382e32340096f40000003dafabcb0000000020fe77258000000001000000000000000200000008526f6f74504f4100000000064d79504f\n410000000000000800000001000000011400000000000002000000010000002000000000000100010000000205010001000100200001010900000001\n0001010000000026000000020002\nIOR=IOR:000000000000001849444c3a48656c6c6f417070322f48656c6c6f3a312e3000000000010000000000000092000102000000000e3135302e\n3235342e37382e32340096f40000003dafabcb0000000020fe77258000000001000000000000000200000008526f6f74504f4100000000064d79504f\n410000000000000800000001000000011400000000000002000000010000002000000000000100010000000205010001000100200001010900000001\n0001010000000026000000020002\norb.run()\;\nHelloServant2:\ constructor\nSM:\ incarnate(oid=\{0,0,0,1,0,0,0,1,\},\ poa='MyPOA')\nsayHello()\ndeactivate()\nSM:\ etherealize(oid=\{0,0,0,1,0,0,0,1,\},\ poa='MyPOA')\nHelloServant2:\ constructor\nSM:\ incarnate(oid=\{0,0,0,1,0,0,0,1,\},\ poa='MyPOA')\nsayHello()\n\nKlient:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/24>java\ HelloClient2\nsayHello=Jak\ sie\ masz\ ???\ndeactivate\nsayHello=Jak\ sie\ masz\ ???\n\n\nZadanie\ 25\ -------------------------------------\n\nSerwer:\n\n//\ HelloServer.java\n//\ Copyright\ and\ License\ \nimport\ HelloApp.*\;\nimport\ org.omg.CosNaming.*\;\nimport\ org.omg.CosNaming.NamingContextPackage.*\;\nimport\ org.omg.CORBA.*\;\nimport\ org.omg.PortableServer.*\;\nimport\ org.omg.PortableServer.POA\;\n\nimport\ java.util.Properties\;\n\nclass\ HelloImpl\ extends\ HelloPOA\ \{\n\ \ private\ ORB\ orb\;\n\n\ \ public\ void\ setORB(ORB\ orb_val)\ \{\n\ \ \ \ orb\ =\ orb_val\;\ \n\ \ \}\n\ \ \ \ \n\ \ //\ implement\ sayHello()\ method\n\ \ public\ String\ sayHello()\ \{\n\ \ \ \ return\ \"\\nHello\ world\ !!\\n\"\;\n\ \ \}\n\ \ \ \ \n\ \ //\ implement\ shutdown()\ method\n\ \ public\ void\ shutdown()\ \{\n\ \ \ \ orb.shutdown(false)\;\n\ \ \}\n\}\n\n\npublic\ class\ HelloServer\ \{\n\n\ \ public\ static\ void\ main(String\ args\[\])\ \{\n\ \ \ \ try\{\n\ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ //\ get\ reference\ to\ rootpoa\ &\ activate\ the\ POAManager\n\ \ \ \ \ \ POA\ rootpoa\ =\ POAHelper.narrow(orb.resolve_initial_references(\"RootPOA\"))\;\n\ \ \ \ \ \ rootpoa.the_POAManager().activate()\;\n\n\ \ \ \ \ \ //\ create\ servant\ and\ register\ it\ with\ the\ ORB\n\ \ \ \ \ \ HelloImpl\ helloImpl\ =\ new\ HelloImpl()\;\n\ \ \ \ \ \ helloImpl.setORB(orb)\;\ \n\n\ \ \ \ \ \ //\ get\ object\ reference\ from\ the\ servant\n\ \ \ \ \ \ org.omg.CORBA.Object\ ref\ =\ rootpoa.servant_to_reference(helloImpl)\;\n\ \ \ \ \ \ Hello\ href\ =\ HelloHelper.narrow(ref)\;\n\ \ \ \ \ \ \ \ \ \ \n\ \ \ \ \ \ //\ get\ the\ root\ naming\ context\n\ \ \ \ \ \ //\ NameService\ invokes\ the\ name\ service\n\ \ \ \ \ \ org.omg.CORBA.Object\ objRef\ =\n\ \ \ \ \ \ \ \ \ \ orb.resolve_initial_references(\"NameService\")\;\n\ \ \ \ \ \ //\ Use\ NamingContextExt\ which\ is\ part\ of\ the\ Interoperable\n\ \ \ \ \ \ //\ Naming\ Service\ (INS)\ specification.\n\ \ \ \ \ \ NamingContextExt\ ncRef\ =\ NamingContextExtHelper.narrow(objRef)\;\n\n\ \ \ \ \ \ //\ bind\ the\ Object\ Reference\ in\ Naming\n\ \ \ \ \ \ String\ name\ =\ \"Hello\"\;\n\ \ \ \ \ \ NameComponent\ path\[\]\ =\ ncRef.to_name(\ name\ )\;\n\ \ \ \ \ \ ncRef.rebind(path,\ href)\;\n\n\ \ \ \ \ \ System.out.println(\"HelloServer\ ready\ and\ waiting\ ...\")\;\n\n\ \ \ \ \ \ //\ wait\ for\ invocations\ from\ clients\n\ \ \ \ \ \ orb.run()\;\n\ \ \ \ \}\ \n\ \ \ \ \ \ \ \ \n\ \ \ \ \ \ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ System.err.println(\"ERROR:\ \"\ +\ e)\;\n\ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \}\n\ \ \ \ \ \ \ \ \ \ \n\ \ \ \ \ \ System.out.println(\"HelloServer\ Exiting\ ...\")\;\n\ \ \ \ \ \ \ \ \n\ \ \}\n\}\n\n\nKlient:\n\nimport\ HelloApp.*\;\nimport\ org.omg.CosNaming.*\;\nimport\ org.omg.CosNaming.NamingContextPackage.*\;\nimport\ org.omg.CORBA.*\;\n\npublic\ class\ HelloClient\n\{\n\ \ static\ Hello\ helloImpl\;\n\n\ \ public\ static\ void\ main(String\ args\[\])\n\ \ \ \ \{\n\ \ \ \ \ \ try\{\n\ \ \ \ \ \ \ \ //\ create\ and\ initialize\ the\ ORB\n\ \ \ \ \ \ \ \ ORB\ orb\ =\ ORB.init(args,\ null)\;\n\n\ \ \ \ \ \ \ \ //\ get\ the\ root\ naming\ context\n\ \ \ \ \ \ \ \ org.omg.CORBA.Object\ objRef\ =\ \n\ \ \ \ \ \ \ \ \ \ \ \ orb.resolve_initial_references(\"NameService\")\;\n\ \ \ \ \ \ \ \ //\ Use\ NamingContextExt\ instead\ of\ NamingContext.\ This\ is\ \n\ \ \ \ \ \ \ \ //\ part\ of\ the\ Interoperable\ naming\ Service.\ \ \n\ \ \ \ \ \ \ \ NamingContextExt\ ncRef\ =\ NamingContextExtHelper.narrow(objRef)\;\n\ \n\ \ \ \ \ \ \ \ //\ resolve\ the\ Object\ Reference\ in\ Naming\n\ \ \ \ \ \ \ \ String\ name\ =\ \"Hello\"\;\n\ \ \ \ \ \ \ \ helloImpl\ =\ HelloHelper.narrow(ncRef.resolve_str(name))\;\n\n\ \ \ \ \ \ \ \ System.out.println(\"Obtained\ a\ handle\ on\ server\ object:\ \"\ +\ helloImpl)\;\n\ \ \ \ \ \ \ \ System.out.println(helloImpl.sayHello())\;\n\ \ \ \ \ \ \ \ //helloImpl.shutdown()\;\n\n\ \ \ \ \ \ \ \ \}\ catch\ (Exception\ e)\ \{\n\ \ \ \ \ \ \ \ \ \ System.out.println(\"ERROR\ :\ \"\ +\ e)\ \;\n\ \ \ \ \ \ \ \ \ \ e.printStackTrace(System.out)\;\n\ \ \ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\nWydruki:\n\nKlient:\n\nkatarzyna@katarzyna-LIFEBOOK-AH531:~/TAS/tematC/25>\ java\ HelloClient\ -ORBInitialPort\ 1050\ -ORBInitialHost\ localhost\nObtained\ a\ handle\ on\ server\ object:\ IOR:000000000000001749444c3a48656c6c6f4170702f48656c6c6f3a312e3000000000000100000000\n00000086000102000000000e3135302e3235342e37382e3234009ce400000031afabcb0000000020fe8db32900000001000000000000000100000008\n526f6f74504f410000000008000000010000000014000000000000020000000100000020000000000001000100000002050100010001002000010109\n000000010001010000000026000000020002\n\nSerwer:\n\nHelloServer\ ready\ and\ waiting\ ...\n\nHello\ world\ !!\n\n\n\n\n\n\n\n
