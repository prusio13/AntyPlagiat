przedmiot TAS temat B nr_indeksu 396443 liczba_pkt 3 

\nZadanie\ 10.1\ -------------------------------------\n//serwer:\n//int\ licznik=0\;\n\ \ public\ int\ powolnaMetoda()\ throws\ RemoteException\n\ \ \{\n\ \ \ \ int\ licznik=0\;\n\ \ \ \ while\ (licznik<10)\{\n\tlicznik++\;\n\ \ \ \ \tSystem.out.println(\"sss:\ powolnaMetoda()\;\ licznik=\"+licznik)\;\n\ \ \ \ \tSystem.out.println(Thread.currentThread())\;\n\ \ \ \ \ttry\ \{Thread.sleep(500)\;\}\ catch(Exception\ e)\{\}\;\n\ \ \ \ \tSystem.out.println(\"sss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\")\;\n\ \ \ \ \t\}\n\ \ \ \ return\ licznik\;\n\ \ \}\n//fragment\ wydruku:\nThread\[RMI\ TCP\ Connection(3)-127.0.0.1,5,RMI\ Runtime\]\nsss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\nsss:\ powolnaMetoda()\;\ licznik=2\nThread\[RMI\ TCP\ Connection(3)-127.0.0.1,5,RMI\ Runtime\]\nsss:\ powolnaMetoda()\;\ licznik=1\nThread\[RMI\ TCP\ Connection(4)-127.0.0.1,5,RMI\ Runtime\]\nsss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\nsss:\ powolnaMetoda()\;\ licznik=3\nThread\[RMI\ TCP\ Connection(3)-127.0.0.1,5,RMI\ Runtime\]\nsss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\nsss:\ powolnaMetoda()\;\ licznik=2\nThread\[RMI\ TCP\ Connection(4)-127.0.0.1,5,RMI\ Runtime\]\nsss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\nsss:\ powolnaMetoda()\;\ licznik=4\n\nZadanie\ 10.2\ --------------------------------------\nw\ serwerze\ komentujemy\ linijkê\n\ \ //UnicastRemoteObject.exportObject(drugiObiekt)\;\nkopiujemy\ plik\ OdleglyObiekt\ do\ klienta.\nTeraz\ w±tek\ realizowany\ jest\ lokalnie,\ co\ widaæ\ w\ tym\ fragmencie\ wydruku:\n//wydruk\nThread\[main,5,main\]\nsss:\ powolnaMetoda()\;\ koniec\ dzialania\ !\nsss:\ powolnaMetoda()\;\ licznik=8\n\nZadanie\ 10.3\ --------------------------------------\nkkk:\ blad\ !!!\ RemoteException\ occurred\ in\ server\ thread\;\ nested\ exception\ is:\ \n\tjava.rmi.RemoteException:\ Sztuczny\ blad\n//komentarz\ jest\ chyba\ zbêdny\ :)\nZadanie\ 11\ ----------------------------------------\n//zob.\ Zad\ 12\nZadanie\ 12\ ----------------------------------------\n//razem\ poniewa¿\ 12\ jest\ rozszerzeniem\ zadania\ 11,\ wiêc\ uzna³em\ ¿e\ nie\ ma\ sensu\ rozbijaæ\ tego\ na\ dwa\ podpunkty.\n//wydruk:\nin:\ 0\nin:\ 1\nout:\ 0\nin:\ 2\nout:\ 1\nin:\ 3\nout:\ 2\n//kluczowe\ fragmenty\ kodu:\nFabrykaBuforow.java:\npublic\ interface\ FabrykaBuforow\ extends\ Remote\n\{\n\tpublic\ OdleglyBufor\ nowyOdleglyBufor()\ throws\ RemoteException\;\n\tpublic\ OdleglyBufor\ nowyOdleglyBufor(String\ nazwa)\ throws\ RemoteException\;\n\}\nOdleglyBufor.java:\npublic\ interface\ OdleglyBufor\ extends\ Remote\n\{\n\tvoid\ wstaw(int\ x)\ throws\ RemoteException\;\n\tint\ pobierz()\ throws\ RemoteException\;\n\}\nsss.java:\n//implementacja\ Bufora:\nclass\ OdleglaKlasa\ implements\ OdleglyBufor,\ Serializable\n\{\n\tpublic\ synchronized\ void\ wstaw(int\ x)\ throws\ RemoteException\{\n\t\tif(ilElem\ ==\ 50)\{throw\ new\ RemoteException(\"full\")\;\}\n\t\telse\{\n\t\t\tif(koniec\ ==\ 50)\{koniec\ =\ 0\;\}\n\t\t\tbufor\[koniec\]=x\;\n\t\t\tilElem++\;\n\t\t\tkoniec++\;\n\t\t\}\n\t\}\n\tpublic\ synchronized\ int\ pobierz()\ throws\ RemoteException\{\n\t\tif(ilElem\ ==\ 0)\{throw\ new\ RemoteException(\"empty\")\;\}\n\t\telse\{\n\t\t\tpoczatek++\;\n\t\t\tilElem--\;\n\t\t\tif(poczatek\ ==\ 50)\{poczatek\ =\ 0\;\ return\ bufor\[49\]\;\}\n\t\t\telse\{return\ bufor\[poczatek-1\]\;\}\n\t\t\t\}\n\t\}\n\tint\ bufor\[\]\;\n\tint\ poczatek\;\n\tint\ koniec\;\n\tint\ ilElem\;\n//\ dwa\ konstruktory:\n\tOdleglaKlasa(String\ nazwa)\ throws\ RemoteException\{\n\t\tsuper()\;\n\t\ttry\ \{\n\t\tUnicastRemoteObject.exportObject(this)\;\n\ \ \ \ \ \ \tNaming.rebind(nazwa,this)\;\n\ \ \ \ \}\ catch(Exception\ e)\ \{\n\ \ \ \ \ \ System.err.println(\"sss:\ OdleglaKlasa(String)\;\ blad\ !!!\ \"+e.getMessage())\;\n\ \ \ \ \}\n\t\tpoczatek=0\;\n\t\tkoniec=0\;\n\t\tilElem=0\;\n\t\tbufor\ =\ new\ int\[50\]\;\ \n\t\}\n\tOdleglaKlasa()\ throws\ RemoteException\{\n\t\tsuper()\;\n\t\ttry\ \{\n\t\tUnicastRemoteObject.exportObject(this)\;\n\ \ \ \ \}\ catch(Exception\ e)\ \{\n\ \ \ \ \ \ System.err.println(\"sss:\ OdleglaKlasa(String)\;\ blad\ !!!\ \"+e.getMessage())\;\n\ \ \ \ \}\n\t\tpoczatek=0\;\n\t\tkoniec=0\;\n\t\tilElem=0\;\n\t\tbufor\ =\ new\ int\[50\]\;\ \n\t\}\n\}\n//\ implementacja\ fabryki\ buforow:\nclass\ Fabryka\ implements\ FabrykaBuforow,\ Serializable\n\{\n\tFabryka(String\ nazwa)\ \{\n\t\tsuper()\;\n\ \ \ \ \t\ttry\{\n\ \ \ \t\t\ \ \ \tUnicastRemoteObject.exportObject(this)\;\n\ \ \ \t\t\ \ \ \tNaming.rebind(nazwa,this)\;\n\ \ \ \t\t\ \}\ catch(Exception\ e)\ \{\n\ \ \ \ \ \t\t\ System.err.println(\"sss:\ FabrykaBuforow()\;\ blad\ !!!\ \"+e.getMessage())\;\n\ \ \ \t\t\}\n\ \ \ \t\ \tSystem.out.println(\"sss:\ FabrykaBuforow()\;\ ok\")\;\n\t\}\n\tpublic\ OdleglaKlasa\ nowyOdleglyBufor()\ throws\ RemoteException\ \n\t\{\n\t\treturn\ new\ OdleglaKlasa()\;\t\n\t\}\n\tpublic\ OdleglaKlasa\ nowyOdleglyBufor(String\ nazwa)\ throws\ RemoteException\ \t\t\{\n\t\treturn\ new\ OdleglaKlasa(nazwa)\;\t\t\n\t\}\n\}\n//main\npublic\ static\ void\ main(String\ args\[\])\n\ \ \{\n\ \ \ \ //System.setSecurityManager(new\ RMISecurityManager())\;\n\n\ \ \ \ try\ \{\n\ \ \ \ \ \tSystem.out.println(\"sss:\ zaczynam\ tworzyc\ obiekty\ ...\")\;\n\t\tFabrykaBuforow\ fabryka\ =\ new\ Fabryka(\"fabryka\")\;\n\ \ \ \ \ \ \tSystem.out.println(\"sss:\ obiekty\ utworzone\ !!!\")\;\n\ \ \ \ \t\}\ catch(Exception\ e)\ \{\n\ \ \ \ \ \ \t\tSystem.err.println(\"sss:\ blad\ !!!\ \"+e.getMessage())\;\n\ \ \ \ \t\t\}\n\ \ \t\t\}\n//\ kkk.java\n//producent:\nprivate\ static\ class\ Producent\ extends\ Thread\n\t\{\n\t\tOdleglyBufor\ bufor\;\n\t\tpublic\ void\ run()\n\t\t\{\n\t\t\tfor(int\ i=0\;\ i<100\;i++)\n\t\t\t\{\n\t\t\t\ttry\n\t\t\t\t\{\n\t\t\t\t\tbufor.wstaw(i)\;\n\t\t\t\t\tSystem.out.println(\"in:\ \"+i)\;\n\t\t\t\t\ttry\{sleep(250)\;\}catch(Exception\ e)\{\}\n\t\t\t\t\}\ catch(RemoteException\ re)\{\n\t\t\t\t\tSystem.out.println(re.getMessage())\;\n\t\t\t\t\ttry\{sleep(250)\;\}catch(Exception\ e)\{\}\t\n\t\t\t\t\t\}\n\t\t\t\t\}\n\t\t\t\}\n\t\tProducent(String\ nazwa)\ throws\ Exception\ \n\t\t\{\n\t\t\tbufor\ =\ (OdleglyBufor)Naming.lookup(\"rmi://localhost/\"+nazwa)\;\n\ \ \t\t\}\n\t\tProducent(OdleglyBufor\ bufor)\ throws\ Exception\ \n\t\t\{\n\ \ \ \t\t\tthis.bufor\ =\ bufor\;\n\t\t\}\n//konsument\ wyglada\ analogicznie,\ nie\ ma\ co\ rozpisywaæ\ zbêdnie\n//main:\n\tpublic\ static\ void\ main(String\ args\[\])\n\t\{\n\ \ \ \ \ttry\ \{\n\t\t\tFabrykaBuforow\ fabryka\ =\ (FabrykaBuforow)Naming.lookup(\"rmi://localhost/fabryka\")\;\n\t\t\ \ \ \tOdleglyBufor\ bufor\ =\ fabryka.nowyOdleglyBufor()\;\n\t\t\tThread\ prod\ =\ new\ Producent(bufor)\;\n\t\t\tThread\ kons\ =\ new\ Konsument(bufor)\;\n\t\t\tprod.start()\;\n\t\t\tkons.start()\;\n\t\ \ \ \ \}\ catch(Exception\ e)\ \{System.err.println(\"kkk:\ blad\ !!!\ \"+e.getMessage())\;\}\n\t\}\n//mialy\ byc\ kluczowe\ fragmenty\ kodu\ a\ wyszlo\ go\ 3/4\ mam\ nadzieje\ ze\ to\ nie\ bedzie\ problem.\n
