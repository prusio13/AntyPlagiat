przedmiot TAS temat A nr_indeksu s396331 liczba_pkt 4 

\r\n\r\nZadanie\ 1:????????????????????..\ \r\nrpcgen\ przet³umaczy³\r\n\ ?struct\ Macierz\ \{\ \r\n\ \ float\ Elem\ <>\;\r\n\ \ int\ IleW\;\ \r\n\ \ int\ IleK\;\r\n\}\;\ \ ?\ \r\n\r\njako\ :\ \r\n?struct\ Macierz\ \{\ \r\n\ \ \ \ \ \ struct\ \{\r\n\ \ \ \ \ \ \ \ \ \ \ u_int\ Elem_len\;\r\n\ \ \ \ \ \ \ \ \ \ \ float\ *Elem_val\;\ \r\n\}Elem\;\r\n\ \ int\ IleW\;\ \r\n\ \ int\ ileK\;\ \r\n\}\ ?\r\nu_int\ Elem_len\ ilo¶æ\ elementów\ w\ macierzy.\ \r\nFloat\ *Elem_val\ wska¼nik\ na\ pierwszy\ element\ w\ macierzy.\ \r\nOdwo³ywanie\ siê\ do\ kolejnych\ elementów\ :\ *(Elem_val+1),\ *(Elem_val+2)\ itd.\ \r\nint\ IleW\ ?\ ilo¶æ\ wierszy,\ int\ IleK\ ?\ ilo¶æ\ kolumn.\ \r\n\r\nZadanie\ 2:???????????????????????.\ \r\nZmiany\ w\ :\ \r\n\ \ \ \ \ \ \ PLIK\ sum_client.c\r\n#ifndef\tDEBUG\r\n\tclnt\ =\ clnt_create\ (host,\ PROGSERVICE,\ VERSERVICE,\ \"udp\")\;\r\n\tif\ (clnt\ ==\ NULL)\ \{\r\n\t\tclnt_pcreateerror\ (host)\;\r\n\t\texit\ (1)\;\r\n\t\}\r\n#endif\t/*\ DEBUG\ */\r\n\ \ \ \ suma_1_arg.x1\ =\ 1\;\r\n\ \ \ \ suma_1_arg.x2\ =\ 3\;\r\n\tresult_1\ =\ suma_1(&suma_1_arg,\ clnt)\;\r\nprintf(\"%d\\n\",\ *result_1)\;\r\n\tif\ (result_1\ ==\ (int\ *)\ NULL)\ \{\r\n\t\tclnt_perror\ (clnt,\ \"call\ failed\")\;\r\n\t\}\r\n\r\n\ \ \ \ \ \ \ PLIK\ \ sum.server.c\r\nint\ *\r\nsuma_1_svc(ParaLi\ *argp,\ struct\ svc_req\ *rqstp)\r\n\{\r\n\tstatic\ int\ \ result\;\r\n\ \ \ \ \ \ result\ =\ argp\ ->\ x1\ +\ argp\ ->\ x2\;\r\n\ \ \ \ \ \ \r\n\ \ \ \ \ return\ &result\;\r\n\}\r\nREZULTAT\ :\ \r\n\r\ns396331@pc18m:~/tassum\$\ ./sum_server\r\n\r\ns396331@pc18m:~/tassum\$\ make\ -f\ Makefile.sum\r\ncc\ -g\ \ \ \ -c\ -o\ sum_clnt.o\ sum_clnt.c\r\ncc\ -g\ \ \ \ -c\ -o\ sum_client.o\ sum_client.c\r\ncc\ -g\ \ \ \ -c\ -o\ sum_xdr.o\ sum_xdr.c\r\ncc\ -g\ \ \ \ \ -o\ sum_client\ \ sum_clnt.o\ sum_client.o\ sum_xdr.o\ -lnsl\ \r\ncc\ -g\ \ \ \ \ -o\ sum_server\ \ sum_svc.o\ sum_server.o\ sum_xdr.o\ -lnsl\r\ns396331@pc18m:~/tassum\$\ ./sum_client\ localhost\r\n4\ \r\n\r\nZadanie\ 3????????????????????????\r\nplik_client.c\ \r\nvoid\r\nprogmacierze_1(char\ *host)\r\n\{\r\n\tCLIENT\ *clnt\;\r\n\tvoid\ \ *result_1\;\r\n\tMac\ \ pokazmacierz_1_arg\;\r\n\tvoid\ \ *result_2\;\r\n\t//TrzyMac\ \ operacjanamacierzach_1_arg\;\r\n\r\n#ifndef\tDEBUG\r\n\tclnt\ =\ clnt_create\ (host,\ ProgMacierze,\ VerMacierze,\ \"udp\")\;\r\n\tif\ (clnt\ ==\ NULL)\ \{\r\n\t\tclnt_pcreateerror\ (host)\;\r\n\t\texit\ (1)\;\r\n\t\}\r\n#endif\t/*\ DEBUG\ */\r\n\r\n\ \ \ \ float\ *f\ =\ calloc(3*3,\ sizeof(float))\;\r\n\r\n\ \ \ \ \ f\[0\]\ =\ 1\;\r\n\ \ \ \ \ f\[1\]\ =\ 2\;\r\n\ \ \ \ \ f\[2\]\ =\ 3\;\r\n\ \ \ \ \ f\[3\]\ =\ 4\;\r\n\ \ \ \ \ f\[4\]\ =\ 5\;\r\n\ \ \ \ \ f\[5\]\ =\ 6\;\r\n\ \ \ \ \ f\[6\]\ =\ 7\;\r\n\ \ \ \ \ f\[7\]\ =\ 8\;\r\n\ \ \ \ \ f\[8\]\ =\ 9\;\r\n\ \ \ \ \r\n\ \ \ \ Elem.Elem_val\ =\ f\;\r\n\ \ \ \ Elem.Elem_len\ =\ 3*3\;\r\n\r\n\ \ \ \ IleK\ =\ 3\;\r\n\ \ \ \ IleW\ =\ 3\;\ \r\n\r\n\ \ \ \ \r\n\tresult_1\ =\ pokazmacierz_1(&pokazmacierz_1_arg,\ clnt)\;\r\n\tif\ (result_1\ ==\ (void\ *)\ NULL)\ \{\r\n\t\tclnt_perror\ (clnt,\ \"call\ failed\")\;\r\n\t\}\r\n\r\ns396331@pc25m:~/tas1\$\ ./plik_server\r\ns396331@pc25m:~/tas1\$\ ./plik_server\r\n\r\nZadanie\ 4??????????????????????????????????????.\r\nPLIK\ plik4.x\ \r\nstruct\ Macierz\ \{\r\n\ \ float\ Elem\ <>\;\r\n\ \ int\ IleW\;\ int\ IleK\;\r\n\}\;\r\nstruct\ DwieMacierze\ \{\ Macierz\ M1\;\ Macierz\ M2\;\ \}\;\r\ntypedef\ struct\ DwieMacierze\ DwieMac\;\r\n\r\nprogram\ ProgMacierze\ \{\r\n\ \ version\ VerMacierze\ \{\r\n\ \ \ \ void\ DodawanieM(DwieMac)\ =\ 1\;\r\n\tvoid\ MnozenieM(DwieMac)\ =\ 2\;\r\n\ \ \}\ =\ 1\;\r\n\}\ =\ 0x21001234\;\r\nPLIK\ plik4.h\ \r\n#ifndef\ _PLIK4_H_RPCGEN\r\n#define\ _PLIK4_H_RPCGEN\r\n\r\n#include\ <rpc/rpc.h>\r\n\r\n\r\n#ifdef\ __cplusplus\r\nextern\ \"C\"\ \{\r\n#endif\r\n\r\n\r\nstruct\ Macierz\ \{\r\n\tstruct\ \{\r\n\t\tu_int\ Elem_len\;\r\n\t\tfloat\ *Elem_val\;\r\n\t\}\ Elem\;\r\n\tint\ IleW\;\r\n\tint\ IleK\;\r\n\}\;\r\ntypedef\ struct\ Macierz\ Macierz\;\r\n\r\nstruct\ DwieMacierze\ \{\r\n\tMacierz\ M1\;\r\n\tMacierz\ M2\;\r\n\}\;\r\ntypedef\ struct\ DwieMacierze\ DwieMacierze\;\r\n\r\ntypedef\ DwieMacierze\ DwieMac\;\r\n\r\n#define\ ProgMacierze\ 0x21001234\r\n#define\ VerMacierze\ 1\r\n\r\n#if\ defined(__STDC__)\ ||\ defined(__cplusplus)\r\n#define\ DodawanieM\ 1\r\nextern\ \ Macierz\ *\ dodawaniem_1(DwieMac\ *,\ CLIENT\ *)\;\r\nextern\ \ Macierz\ *\ dodawaniem_1_svc(DwieMac\ *,\ struct\ svc_req\ *)\;\r\n#define\ MnozenieM\ 2\r\nextern\ \ Macierz\ *\ mnozeniem_1(DwieMac\ *,\ CLIENT\ *)\;\r\nextern\ \ Macierz\ *\ mnozeniem_1_svc(DwieMac\ *,\ struct\ svc_req\ *)\;\r\nextern\ int\ progmacierze_1_freeresult\ (SVCXPRT\ *,\ xdrproc_t,\ caddr_t)\;\r\n\r\n#else\ /*\ K&R\ C\ */\r\n#define\ DodawanieM\ 1\r\nextern\ \ Macierz\ *\ dodawaniem_1()\;\r\nextern\ \ Macierz\ *\ dodawaniem_1_svc()\;\r\n#define\ MnozenieM\ 2\r\nextern\ \ Macierz\ *\ mnozeniem_1()\;\r\nextern\ \ Macierz\ *\ mnozeniem_1_svc()\;\r\nextern\ int\ progmacierze_1_freeresult\ ()\;\r\n#endif\ /*\ K&R\ C\ */\r\n\r\n/*\ the\ xdr\ functions\ */\r\n\r\n#if\ defined(__STDC__)\ ||\ defined(__cplusplus)\r\nextern\ \ bool_t\ xdr_Macierz\ (XDR\ *,\ Macierz*)\;\r\nextern\ \ bool_t\ xdr_DwieMacierze\ (XDR\ *,\ DwieMacierze*)\;\r\nextern\ \ bool_t\ xdr_DwieMac\ (XDR\ *,\ DwieMac*)\;\r\n\r\n#else\ /*\ K&R\ C\ */\r\nextern\ bool_t\ xdr_Macierz\ ()\;\r\nextern\ bool_t\ xdr_DwieMacierze\ ()\;\r\nextern\ bool_t\ xdr_DwieMac\ ()\;\r\n\r\n#endif\ /*\ K&R\ C\ */\r\n\r\n#ifdef\ __cplusplus\r\n\}\r\n#endif\r\n\r\n#endif\ /*\ !_PLIK4_H_RPCGEN\ */\r\n\r\nPLIK\ plik4_client.c\ \r\n#include\ \"plik4.h\"\r\n\r\n\r\nvoid\r\nprogmacierze_1(char\ *host)\r\n\{\r\n\tCLIENT\ *clnt\;\r\n\tMacierz\ \ *result_1\;\r\n\tDwieMac\ \ dodawaniem_1_arg\;\r\n\tMacierz\ \ *result_2\;\r\n\tDwieMac\ \ mnozeniem_1_arg\;\r\n\r\n#ifndef\tDEBUG\r\n\tclnt\ =\ clnt_create\ (host,\ ProgMacierze,\ VerMacierze,\ \"udp\")\;\r\n\tif\ (clnt\ ==\ NULL)\ \{\r\n\t\tclnt_pcreateerror\ (host)\;\r\n\t\texit\ (1)\;\r\n\t\}\r\n\r\n\r\n#endif\t/*\ DEBUG\ */\r\n\r\n\r\nresult_1->Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\tresult_2->Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\r\n\tdodawaniem_1_arg.M1.Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\tdodawaniem_1_arg.M2.Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\t\r\n\tmnozeniem_1_arg.M1.Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\tmnozeniem_1_arg.M2.Elem.Elem_val\ =\ (float*)\ calloc(4,\ sizeof(float))\;\r\n\r\n\tdodawaniem_1_arg.M1.IleW\ =\ 2\;\r\n\tdodawaniem_1_arg.M1.IleK\ =\ 2\;\r\n\tdodawaniem_1_arg.M1.Elem.Elem_val\[0\]\ =\ 1\;\r\n\tdodawaniem_1_arg.M1.Elem.Elem_val\[1\]\ =\ 2\;\r\n\tdodawaniem_1_arg.M1.Elem.Elem_val\[2\]\ =\ 3\;\r\n\tdodawaniem_1_arg.M1.Elem.Elem_val\[3\]\ =\ 4\;\r\n\r\n\tdodawaniem_1_arg.M2.IleW\ =\ 2\;\r\n\tdodawaniem_1_arg.M2.IleK\ =\ 2\;\r\n\tdodawaniem_1_arg.M2.Elem.Elem_val\[0\]\ =\ 10\;\r\n\tdodawaniem_1_arg.M2.Elem.Elem_val\[1\]\ =\ 20\;\r\n\tdodawaniem_1_arg.M2.Elem.Elem_val\[2\]\ =\ 30\;\r\n\tdodawaniem_1_arg.M2.Elem.Elem_val\[3\]\ =\ 40\;\r\n\t\r\n\tmnozeniem_1_arg.M1.IleW\ =\ 2\;\r\n\tmnozeniem_1_arg.M1.IleK\ =\ 2\;\r\n\tmnozeniem_1_arg.M1.Elem.Elem_val\[0\]\ =\ 1\;\r\n\tmnozeniem_1_arg.M1.Elem.Elem_val\[1\]\ =\ 2\;\r\n\tmnozeniem_1_arg.M1.Elem.Elem_val\[2\]\ =\ 3\;\r\n\tmnozeniem_1_arg.M1.Elem.Elem_val\[3\]\ =\ 4\;\r\n\r\n\tmnozeniem_1_arg.M2.IleW\ =\ 2\;\r\n\tmnozeniem_1_arg.M2.IleK\ =\ 2\;\r\n\tmnozeniem_1_arg.M2.Elem.Elem_val\[0\]\ =\ 10\;\r\n\tmnozeniem_1_arg.M2.Elem.Elem_val\[1\]\ =\ 20\;\r\n\tmnozeniem_1_arg.M2.Elem.Elem_val\[2\]\ =\ 30\;\r\n\tmnozeniem_1_arg.M2.Elem.Elem_val\[3\]\ =\ 40\;\r\n\r\n\tint\ i\;\r\n\tfor(i=0\;\ i<dodawaniem_1_arg.M1.IleW*dodawaniem_1_arg.M1.IleK\;\ i++)\ \{\r\n\t\tresult_1\ =\ dodawaniem_1(&dodawaniem_1_arg,\ clnt)\;\r\n\t\tprintf(\"%f\ \",\ result_1->Elem.Elem_val\[i\])\;\r\n\t\}\r\n\tprintf(\"\\n\")\;\r\n\r\n\tint\ j\;\r\n\tfor(j=0\;\ j<mnozeniem_1_arg.M1.IleW*mnozeniem_1_arg.M1.IleK\;\ j++)\ \{\r\n\t\tresult_1\ =\ mnozeniem_1(&mnozeniem_1_arg,\ clnt)\;\r\n\t\tprintf(\"%f\ \",\ result_1->Elem.Elem_val\[j\])\;\r\n\t\}\r\n\tprintf(\"\\n\")\;\r\n\r\n\r\n\r\n\r\n\r\n\tresult_1\ =\ dodawaniem_1(&dodawaniem_1_arg,\ clnt)\;\r\n\tif\ (result_1\ ==\ (void\ *)\ NULL)\ \{\r\n\t\tclnt_perror\ (clnt,\ \"call\ failed\")\;\r\n\t\}\r\n\tresult_2\ =\ mnozeniem_1(&mnozeniem_1_arg,\ clnt)\;\r\n\tif\ (result_2\ ==\ (void\ *)\ NULL)\ \{\r\n\t\tclnt_perror\ (clnt,\ \"call\ failed\")\;\r\n\t\}\r\n#ifndef\tDEBUG\r\n\tclnt_destroy\ (clnt)\;\r\n#endif\t\ /*\ DEBUG\ */\r\n\}\r\n\r\n\r\nint\r\nmain\ (int\ argc,\ char\ *argv\[\])\r\n\{\r\n\tchar\ *host\;\r\n\r\n\tif\ (argc\ <\ 2)\ \{\r\n\t\tprintf\ (\"usage:\ %s\ server_host\\n\",\ argv\[0\])\;\r\n\t\texit\ (1)\;\r\n\t\}\r\n\thost\ =\ argv\[1\]\;\r\n\tprogmacierze_1\ (host)\;\r\nexit\ (0)\;\r\n\}\r\n\r\nPLIK\ plik4_server.c\r\n#include\ \"plik4.h\"\r\n\r\nMacierz\ *\r\ndodawaniem_1_svc(DwieMac\ *argp,\ struct\ svc_req\ *rqstp)\r\n\{\r\n\tstatic\ Macierz\ *\ result\;\r\n\r\n\tresult->Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\targp->M1.Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\targp->M2.Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\r\n\tint\ i\;\r\n\tfor(i=0\;\ i<argp->M1.IleW*argp->M2.IleK\;\ i++)\ \{\r\n\t\tresult->Elem.Elem_val\[i\]\ =\ argp->M1.Elem.Elem_val\[i\]\ +\ argp->M2.Elem.Elem_val\[i\]\;\r\n\t\}\r\n\r\n\treturn\ result\;\r\n\}\r\n\r\nMacierz\ *\r\nmnozeniem_1_svc(DwieMac\ *argp,\ struct\ svc_req\ *rqstp)\r\n\{\r\n\tstatic\ Macierz\ *\ result\;\r\n\r\n\tresult->Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\targp->M1.Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\targp->M2.Elem.Elem_val\ =\ (float*)\ calloc(argp->M1.IleW*argp->M2.IleK,\ sizeof(float))\;\r\n\r\n\tint\ i\;\r\n\tfor(i=0\;\ i<argp->M1.IleW*argp->M2.IleK\;\ i++)\ \{\r\n\t\tresult->Elem.Elem_val\[i\]\ =\ argp->M1.Elem.Elem_val\[i\]\ *\ argp->M2.Elem.Elem_val\[i\]\;\r\n\t\}\r\n\r\n\treturn\ result\;\r\n\}\r\n\r\nPLIK\ plik4_clnt.c\r\n#include\ <memory.h>\ /*\ for\ memset\ */\r\n#include\ \"plik4.h\"\r\n\r\n/*\ Default\ timeout\ can\ be\ changed\ using\ clnt_control()\ */\r\nstatic\ struct\ timeval\ TIMEOUT\ =\ \{\ 25,\ 0\ \}\;\r\n\r\nMacierz\ *\r\ndodawaniem_1(DwieMac\ *argp,\ CLIENT\ *clnt)\r\n\{\r\n\tstatic\ Macierz\ clnt_res\;\r\n\r\n\tmemset((char\ *)&clnt_res,\ 0,\ sizeof(clnt_res))\;\r\n\tif\ (clnt_call\ (clnt,\ DodawanieM,\r\n\t\t(xdrproc_t)\ xdr_DwieMac,\ (caddr_t)\ argp,\r\n\t\t(xdrproc_t)\ xdr_void,\ (caddr_t)\ &clnt_res,\r\n\t\tTIMEOUT)\ !=\ RPC_SUCCESS)\ \{\r\n\t\treturn\ (NULL)\;\r\n\t\}\r\n\treturn\ &clnt_res\;\r\n\}\r\n\r\nMacierz\ *\r\nmnozeniem_1(DwieMac\ *argp,\ CLIENT\ *clnt)\r\n\{\r\n\tstatic\ Macierz\ clnt_res\;\r\n\r\n\tmemset((char\ *)&clnt_res,\ 0,\ sizeof(clnt_res))\;\r\n\tif\ (clnt_call\ (clnt,\ MnozenieM,\r\n\t\t(xdrproc_t)\ xdr_DwieMac,\ (caddr_t)\ argp,\r\n\t\t(xdrproc_t)\ xdr_void,\ (caddr_t)\ &clnt_res,\r\n\t\tTIMEOUT)\ !=\ RPC_SUCCESS)\ \{\r\n\t\treturn\ (NULL)\;\r\n\t\}\r\n\treturn\ &clnt_res\;\r\n\}\r\nPierwsza\ konsola\r\ns396331@pc25m:~/Zadanie4Tasy\$\ make\ -f\ Makefile.plik4\r\ncc\ -g\ \ \ \ -c\ -o\ plik4_clnt.o\ plik4_clnt.c\r\ncc\ -g\ \ \ \ -c\ -o\ plik4_client.o\ plik4_client.c\r\ncc\ -g\ \ \ \ -c\ -o\ plik4_xdr.o\ plik4_xdr.c\r\ncc\ -g\ \ \ \ \ -o\ plik4_client\ \ plik4_clnt.o\ plik4_client.o\ plik4_xdr.o\ -lnsl\ \r\ncc\ -g\ \ \ \ -c\ -o\ plik4_server.o\ plik4_server.c\r\ncc\ -g\ \ \ \ \ -o\ plik4_server\ \ plik4_svc.o\ plik4_server.o\ plik4_xdr.o\ -lnsl\r\ns396331@pc25m:~/Zadanie4Tasy\$\ ./plik4_server\r\n\r\nDruga\ konsola\r\ns396331@pc25m:~/Zadanie4Tasy\$\ ./plik4_client\ localhost\r\nNaruszenie\ ochrony\ pamiêci\ (zrzut\ pamiêci)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n
