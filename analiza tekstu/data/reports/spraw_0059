przedmiot TAS temat C nr_indeksu 384066 liczba_pkt 5 

\n\n\nZADANIE\ 40\t\n\nNa\ zajeciach\ ustalilismy,\ ze\ zamiast\ macierz\ mozna\ pomnozyc\ wektor\ przez\ skalar.\nW\ pliku\ pliku\ q.c:\n\n#include\ \"qqqSoap.nsmap\"\n#include\ <stdio.h>\n\nint\ main()\ \n\{\ \n\ \ \ struct\ soap\ soap\;\ \n\ \ \ soap_init(&soap)\;\ //\ initialize\ runtime\ environment\ \n\ \ \ \n\ \ \ struct\ ns1__razyDwaRequest\ ar\;\n\ \ \ struct\ ns1__razyDwaResults\ ar2\;\n\ \ \ \n\ \ \ //\ Dane\ wej¶ciowe\n\ \ \ const\ int\ szerokosc=55\;\n\ \ \ ar.par1=\ soap_malloc(&soap,\ szerokosc*sizeof(float))\;\ \n\ \ \ \ \ \ //\ dane\ alokowane\ w\ taki\ sposob\ beda\ automatycznie\ zwalniane\ przy\ soap_end()\n\ \ \ ar.__sizepar1\ =\ szerokosc\;\n\ \ \ int\ i\;\n\ \ \ for(i=0\;\ i<szerokosc\;\ i++)\ ar.par1\[i\]=\ i+1\;\n\n\ \ \ //\ Operacje\n\ \ \ //\ Http\ do\ serwera\ \"http://localhost:8015/soap/qqq/go\"\ \ \ \n\ \ \ if(\ soap_call___ns1__razyDwa(&soap,\ \n\ \ \ \ \ \ \ \ \ NULL,\ NULL,\ &ar,\ &ar2)\ !=SOAP_OK\ )\ \{\n\ \ \ \ \ \ \ soap_print_fault(&soap,\ stderr)\;\n\ \ \ \ \ \}\n\n\ \ \ //\ Wy¶wietlenie\ argumentów\ oraz\ wyniku\n\ \ \ int\ d\;\n\ \ \ printf(\"argument:\\n\")\;\ d=\ ar.__sizepar1\;\n\ \ \ for(i=0\;\ i<d\;\ i++)\ printf(\"%d\ \",\ ar.par1\[i\])\;\ printf(\"\\n\")\;\n\ \ \ printf(\"wynik:\\n\")\;\ d=\ ar2.__sizerazyDwaResult\;\n\ \ \ for(i=0\;\ i<d\;\ i++)\ printf(\"%d\ \",\ ar2.razyDwaResult\[i\])\;\ printf(\"\\n\")\;\n\n\ \ \ //\ Czyszczenie\ pamiêci\n\ \ \ soap_end(&soap)\;\ //\ clean\ up\ and\ remove\ deserialized\ data\ \n\ \ \ soap_done(&soap)\;\ //\ detach\ environment\ (last\ use\ and\ no\ longer\ in\ scope)\n\ \ \ \n\ \ \ return\ 0\;\n\}\n\nWydruk\ z\ konsoli:\n\nKlient:\n\nArgument:\n1\ 2\ 3\ 4\ 5\ 6\ 7\ 8\ 9\ 10\ 11\ 12\ 13\ 14\ 15\ 16\ 17\ 18\ 19\ 20\ 21\ 22\ 23\ 24\ 25\ 26\ 27\ 28\ 29\ 30\ 31\ 32\ 33\ 34\ 35\ 36\ 37\ 38\ 39\ 40\ 41\ 42\ 43\ 44\ 45\ 46\ 47\ 48\ 49\ 50\ 51\ 52\ 53\ 54\ 55\ \nWynik:\n2\ 4\ 6\ 8\ 10\ 12\ 14\ 16\ 18\ 20\ 22\ 24\ 26\ 28\ 30\ 32\ 34\ 36\ 38\ 40\ 42\ 44\ 46\ 48\ 50\ 52\ 54\ 56\ 58\ 60\ 62\ 64\ 66\ 68\ 70\ 72\ 74\ 76\ 78\ 80\ 82\ 84\ 86\ 88\ 90\ 92\ 94\ 96\ 98\ 100\ 102\ 104\ 106\ 108\ 110\ \n\n\n\n\n\n\n\nZADANIE\ 41\n\n\nW\ pliku\ q.h:\n\n//gsoap\ ns\ service\ name:\ qqq\n//gsoap\ ns\ service\ namespace:\ qqq\n\n//gsoap\ ns\ service\ style:\ rpc\n//gsoap\ ns\ service\ encoding:\ encoded\n\nstruct\ t_seq\ \{\n\ \ int\ *__ptr\;\ \n\ \ int\ __size\;\n\}\;\n\nstruct\ t_Macierz\ \{\n\ \ struct\ t_seq\ data\;\ \n\ \ int\ wiersze,\ kolumny\;\n\}\;\n\nstruct\ ns__razyMacierzResponse\ \{\n\tstruct\ t_Macierz*\ return_\;\n\}\;\n\nint\ ns__razyMacierz(\ struct\ t_Macierz\ mat1,\ struct\ t_Macierz\ mat2,\ struct\ ns__razyMacierzResponse*\ return_\ )\;\n\n\nW\ pliku\ q.c\n\n#include\ \"qqq.nsmap\"\n\nint\ main()\ \{\n\ \ struct\ soap\ soap\;\n\ \ soap_init(&soap)\;\n\n\ \ int\ b=soap_bind(&soap,\ NULL,\ 10000,\ 100)\;\ \n\ \ \ \ \ //\ 10000\ Port\ na\ którym\ oczekuje\ serwer\n\ \ if(b<0)\ \{soap_print_fault(&soap,\ stderr)\;\ soap_done(&soap)\;\ exit(1)\;\}\n\n\ \ while\ (1)\ \{\n\ \ \ \ soap_accept(&soap)\;\ //\ czeka\ na\ soap\ msg\n\ \ \ \ soap_serve(&soap)\;\ //\ obsluga\ klienta\n\ \ \ \ \ \ //\ UWAGA:\ mo¿na\ w\ tym\ miejscu\ tworzyc\ w±tek\ POSIX\ i\ przekazywaæ\ mu\ obs³ugê\ klienta\ !!!\n\ \ \ \ soap_end(&soap)\;\ //\ zwalniani\ pamieci\n\ \ \ \ printf(\".\")\;\ fflush(stdout)\;\n\ \ \}\n\n\ \ return\ 0\;\n\}\n\nint\ ns__razyMacierz(\ struct\ soap*\ soap,\ struct\ t_Macierz\ mat1,\ struct\ t_Macierz\ mat2,\ struct\ ns__razyMacierzResponse*\ return_\ )\n\{\ \ \n\ \ int\ i,j,k\;\n\ \ int\ d\ =\ mat1.wiersze\ *\ mat2.kolumny\;\n\ \ \n\ \ return_->return_\ =\ soap_malloc(soap,\ sizeof(struct\ t_Macierz))\;\n\n\ \ return_->return_->wiersze\ =\ mat1.wiersze\;\n\ \ return_->return_->kolumny\ =\ mat2.kolumny\;\n\n\ \ return_->return_->data.__ptr\ =\ soap_malloc(soap,\ d*sizeof(int))\;\n\ \ return_->return_->data.__size\ =\ d\;\n\n\ \ printf(\"serwer/dbg:\ argument:\\n\")\;\n\ \ for(\ i\ =\ 0\;\ i\ <\ mat1.wiersze\;\ i++\ )\ \{\n\t\ \ for(\ j\ =\ 0\;\ j\ <\ mat2.kolumny\;\ j++\ )\ \{\n\ \ \ \ \ \ \ \ return_->return_->data.__ptr\[\ i\ *\ mat2.kolumny\ +\ j\ \]\ =\ 0\;\ \n\n\ \ \ \ \ \ \ \ for(\ k\ =\ 0\;\ k\ <\ mat1.kolumny\;\ k++\ )\ \{\n\ \ \ \ \ \ \ \ \ \ \ \ return_->return_->data.__ptr\[\ i\ *\ mat2.kolumny\ +\ j\ \]\ +=\ \n\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mat1.data.__ptr\[\ i\ *\ mat1.kolumny\ +\ k\ \]\ *\ mat2.data.__ptr\[\ k\ *\ mat2.kolumny\ +\ j\ \]\ \;\n\ \ \ \ \ \ \ \ \}\n\ \ \ \ \}\n\ \ \}\n\n\ \ return\ SOAP_OK\;\n\}\n\n\n\n\nW\ pliku\ k.java:\nimport\ qqq_pkg.*\;\nimport\ java.util.*\;\n\n\n\npublic\ class\ k\n\{\n\ \ public\ static\ void\ main(String\ args\[\])\n\ \ \{\n\ \ \ \ \ try\ \{\n\tqqq_pkg.QqqLocator\ loc\ =\ new\ qqq_pkg.QqqLocator()\;\n\t\n\tint\[\]\ tab\ =\ new\ int\[9\]\;\n\tfor(\ int\ i\ =\ 0\;\ i\ <\ 9\;\ i++\ )\ tab\[i\]\ =\ 1\;\n\tint\[\]\ tab3\ =\ new\ int\[9\]\;\n\tfor(\ int\ i\ =\ 0\;\ i\ <\ 9\;\ i++\ )\ tab3\[i\]\ =\ 2\;\n\n\tqqq_pkg.TMacierz\ mac\ =\ new\ qqq_pkg.TMacierz(\ tab,\ 3,\ 3\ )\;\n\tqqq_pkg.TMacierz\ mac1\ =\ new\ qqq_pkg.TMacierz(\ tab3,\ 3,\ 3\ )\;\n\n\tqqq_pkg.QqqPortType\ obiekt\ =\ loc.getqqq(\ )\;\n\tqqq_pkg.TMacierz\ res\ =\ obiekt.razyMacierz(\ mac,\ mac1\ )\;\n\n\tint\[\]\ tab2\ =\ res.getData()\;\n\tint\ k\ =\ res.getKol()\;\n\tint\ w\ =\ res.getWie()\;\n\t\n\tSystem.out.printf(\ \"%d\ %d\\n\",\ k,\ w\ )\;\n\tfor(\ int\ i\ =\ 0\;\ i\ <\ k\;\ i++\ )\ \{\n\t\tfor(\ int\ j\ =\ 0\;\ j\ <\ w\;\ j++\ )\n\t\t\{\n\t\t\tSystem.out.print(\ tab2\[\ j\ *\ k\ +\ i\ \]\ )\;\n\t\t\tSystem.out.print(\ \"\ \"\ )\;\n\t\t\}\n\n\t\ \ \ \ \ \ \ \ System.out.print(\ \"\\n\"\ )\;\n\t\}\n\n\ \ \ \ \ \}\ catch\ (\ Exception\ e\ )\ \{\n\t\ System.err.print(\ \"error\"\ +\ e.getMessage()\ +\ \"\\n\"\ )\;\n\ \ \ \ \ \}\n\ \ \}\n\}\n\nW\ plik\ qqqLocator.java\ domy¶lny\ port\ zosta³\ zmieniony\ na\ 10000.\n\nMno¿e\ 2\ macierze\ 3x3,\ pierwsza\ zlozona\ z\ samych\ jedynek,\ a\ druga\ z\ samych\ swojek.\n\nWydruki\ z\ konsoli:\nSerwer:\nagnieszka@X550L:~/Desktop/tas/D/Zad41\$\ ./a.out\ \nserwer/dbg:\ argument:\ ###\ oznacza\ ze\ serwer\ przyjal\ zadanie\ i\ wywowa³\ zdaln±\ procedurê\n\n\nWydruk\ z\ klienta:\n3\ 3\n6\ 6\ 6\ \n6\ 6\ 6\ \n6\ 6\ 6\ \n\n\n\n\n\n\n\n\nZADANIE\ 43\n\nPlik\ obs³uguj±cy\ webservice:\n\n#include\ <iostream>\n#include\ <istream>\n#include\ <ostream>\n#include\ <string>\n#include\ <cstdio>\n#include\ <vector>\n#include\ <regex>\n#include\ <boost/asio.hpp>\n\nusing\ boost::asio::ip::tcp\;\nusing\ namespace\ std\;\n\n\nstring\ req\ =\ \"\\\n<?xml\ version=\\\"1.0\\\"\ encoding=\\\"UTF-8\\\"?>\\\n<SOAP-ENV:Envelope\\\n\ xmlns:SOAP-ENV=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\"\\\n\ xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\"\\\n\ xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"\\\n\ xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"\\\n\ xmlns:ns1=\\\"http://127.0.0.1:30000/service/qqq\\\">\\\n\ <SOAP-ENV:Body>\\\n\ \ \ <ns1:razyDwaRequest\ xsi:type=\\\"ns1:razyDwaRequest\\\">\"\;\n\ \nstring\ suffix\ =\ \ \ \"</ns1:razyDwaRequest>\\\n\\\n\ </SOAP-ENV:Body>\\\n</SOAP-ENV:Envelope>\"\;\n\nint\ main(int\ argc,\ char*\ argv\[\])\n\{\n\n\ \ int\ n\;\n\ \ scanf(\ \"%d\",\ &n\ )\;\n\n\ \ for(\ int\ i\ =\ 0\;\ i\ <\ n\;\ i++\ )\ \{\n\tint\ a\;\n\ \ \ \ scanf(\ \"%d\",\ &a\ )\;\n\ \ \ \ //\ dodajemy\ elementy\ do\ zapytania\n\treq\ +=\ \"<ns1:par1\ xsi:type=\\\"xsd:int\\\">\"\;\n\ \ \ \ req\ +=\ std::to_string(\ a\ )\;\n\ \ \ \ req\ +=\ \"</ns1:par1>\"\;\n\n\ \ \}\n\n\ \ req\ +=\ suffix\;\n\n\ \ string\ res\;\n\ \ string\ res_tmp\;\n\n\ \ try\n\ \ \{\n\n\ \ \ \ boost::asio::io_service\ io_service\;\n\n\ \ \ \ //\ Get\ a\ list\ of\ endpoints\ corresponding\ to\ the\ server\ name.\n\ \ \ \ tcp::resolver\ resolver(io_service)\;\n\ \ \ \ tcp::resolver::query\ query(\"localhost\",\ \"30000\")\;\n\ \ \ \ tcp::resolver::iterator\ endpoint_iterator\ =\ resolver.resolve(query)\;\n\n\ \ \ \ tcp::socket\ socket(io_service)\;\n\n\tprintf(\"Try\ to\ connect\\n\")\;\n\n\ \ \ \ boost::asio::connect(socket,\ endpoint_iterator)\;\n\n\tprintf(\"Connected\\n\")\;\n\n\ \ \ \ boost::asio::streambuf\ request\;\n\ \ \ \ std::ostream\ request_stream(&request)\;\n\ \ \ \ request_stream\ <<\ \"POST\ \"\ <<\ \"/service/qqq/op\"\ <<\ \"\ HTTP/1.0\\r\\n\"\;\n\ \ \ \ request_stream\ <<\ \"Host:\ \"\ <<\ \"localhost:30000\"\ <<\ \"\\r\\n\"\;\n\ \ \ \ request_stream\ <<\ \"Accept:\ */*\\r\\n\"\;\n\trequest_stream\ <<\ \"Content-Type:\ text/xml\\r\\n\"\;\n\trequest_stream\ <<\ \"Content-Length:\ \"<<\ req.size()\ <<\"\\r\\n\\r\\n\"\;\n\n\trequest_stream\ <<\ req\;\n\n\ \ \ \ boost::asio::write(socket,\ request)\;\n\n\ \ \ \ boost::asio::streambuf\ response\;\n\ \ \ \ boost::asio::read_until(socket,\ response,\ \"\\r\\n\")\;\n\n\ \ \ \ std::istream\ response_stream(&response)\;\n\ \ \ \ std::string\ http_version\;\n\ \ \ \ response_stream\ >>\ http_version\;\n\ \ \ \ unsigned\ int\ status_code\;\n\ \ \ \ response_stream\ >>\ status_code\;\n\ \ \ \ std::string\ status_message\;\n\ \ \ \ std::getline(response_stream,\ status_message)\;\n\ \ \ \ if\ (!response_stream\ ||\ http_version.substr(0,\ 5)\ !=\ \"HTTP/\")\n\ \ \ \ \{\n\ \ \ \ \ \ std::cout\ <<\ \"Invalid\ response\\n\"\;\n\ \ \ \ \ \ return\ 1\;\n\ \ \ \ \}\n\ \ \ \ if\ (status_code\ !=\ 200)\n\ \ \ \ \{\n\ \ \ \ \ \ std::cout\ <<\ \"Response\ returned\ with\ status\ code\ \"\ <<\ status_code\ <<\ \"\\n\"\;\n\ \ \ \ \ \ return\ 1\;\n\ \ \ \ \}\n\n\ \ \ \ //\ Read\ the\ response\ headers,\ which\ are\ terminated\ by\ a\ blank\ line.\n\ \ \ \ boost::asio::read_until(socket,\ response,\ \"\\r\\n\\r\\n\")\;\n\n\ \ \ \ std::string\ header\;\n\ \ \ \ while\ (std::getline(response_stream,\ header)\ &&\ header\ !=\ \"\\r\")\;\n\ \ \ \ std::cout\ <<\ \"\\n\"\;\n\n\ \ \ \ if\ (response.size()\ >\ 0)\ \{\n\t\tstd::getline(response_stream,\ res_tmp)\;\n\t\tres\ +=\ res_tmp\;\ \ \ \ \n\t\}\n\n\ \ \ \ boost::system::error_code\ error\;\n\ \ \ \ while\ (boost::asio::read(socket,\ response,\n\ \ \ \ \ \ \ \ \ \ boost::asio::transfer_at_least(1),\ error))\ \{\n\t\tstd::getline(response_stream,\ res_tmp)\;\n\t\tres\ +=\ res_tmp\;\ \ \n\ \ \ \ \}\n\ \ \ \ \ \ //std::cout\ <<\ &response\;\n\ \ \ \ if\ (error\ !=\ boost::asio::error::eof)\n\ \ \ \ \ \ throw\ boost::system::system_error(error)\;\n\ \ \}\n\ \ catch\ (std::exception&\ e)\n\ \ \{\n\ \ \ \ std::cout\ <<\ \"Exception:\ \"\ <<\ e.what()\ <<\ \"\\n\"\;\n\ \ \}\n\n\ \ res\ =\ \"\ \"\ +\ res\;\n\n\ \ int\ d\ =\ 0\;\n\ \ int\ d_temp\;\n\ \ char\ c\;\n\n\ \ \twhile\ (sscanf(\ res.c_str()\ +\ d,\ \ \"%*\[^<\]%c%n\",\ &c,\ &d_temp)\ ==\ 1)\n\t\{\n\ \t\td\ +=\ d_temp\;\n\t\tint\ n\;\n\t\tif\ (sscanf(\ res.c_str()\ +\ d,\ \"qqq:razyDwaResult>%d</qqq:razyDwaResult>%n\",\ &n,\ &d_temp)\ ==\ 1)\ \{\n\t\t\tprintf(\"%d\ \",\ n)\;\n\t\t\td\ +=\ d_temp\ -\ 1\;\t\t\n\t\t\}\n\t\}\n\n\ \ printf(\ \"\\n\"\ )\;\n\n\ \ return\ 0\;\n\}\n\nWydruk\ z\ konsoli:\n\nProces\ kompilacji:\ng++\ q.cpp\ -lboost_system\ -lpthread\ -std=c++11\n\nagnieszka@X550L:~/Desktop/tas/D/Zad43\$\ ./a.out\ \n8\ 2\ 4\ 7\ 9\ 10\ 20\ 30\ 40\nTry\ to\ connect\nConnected\n\n4\ 8\ 14\ 18\ 20\ 40\ 60\ 80\ \n\nWys³any\ SOAP:\n<?xml\ version=\"1.0\"\ encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope\n\ xmlns:SOAP-ENV=\\\"http://schemas.xmlsoap.org/soap/envelope/\"\n\ xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\"\n\ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\ xmlns:ns1=\"http://127.0.0.1:30000/service/qqq\">\n\ <SOAP-ENV:Body>\n\ \ \ <ns1:razyDwaRequest\ xsi:type=\"ns1:razyDwaRequest\">\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">4</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">4</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">7</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">9</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">10</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">20</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">30</ns1:par1>\n\ \ \ \ \ \ \ <ns1:par1\ xsi:type=\"xsd:int\">40</ns1:par1>\n</ns1:razyDwaRequest>\n\ </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n\nOdpowied¼\ HTTP:\nContent-Type:\ text/xml\;\ charset=UTF-8\nConnection:\ close\nContent-length:\ 741\n\n<?xml\ version=\"1.0\"\ \ encoding=\"utf-8\"?>\n<SOAP-ENV:Envelope\ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\ xmlns:xsi=\"http://www.w3.org/1999/XMLSchema-instance\"\ \nxmlns:xsd=\"http://www.w3.org/1999/XMLSchema\"\ \nxmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\ \nxmlns:qqq=\"http://127.0.0.1:30000/service/qqq\"><SOAP-ENV:Body>\n<qqq:razyDwaResults>\n<qqq:razyDwaResult>4</qqq:razyDwaResult>\n<qqq:razyDwaResult>8</qqq:razyDwaResult>\n<qqq:razyDwaResult>14</qqq:razyDwaResult>\n<qqq:razyDwaResult>18</qqq:razyDwaResult>\n<qqq:razyDwaResult>20</qqq:razyDwaResult>\n<qqq:razyDwaResult>40</qqq:razyDwaResult>\n<qqq:razyDwaResult>60</qqq:razyDwaResult>\n<qqq:razyDwaResult>80</qqq:razyDwaResult>\n</qqq:razyDwaResults></SOAP-ENV:Body></SOAP-ENV:Envelope>\n\n\n\n\n\n\n\n\n\nZADANIE\ 46\n\n\nW\ pliku\ q.h:\n\n//gsoap\ ns\ service\ name:\ qqq\n//gsoap\ ns\ service\ namespace:\ qqq\n\n//gsoap\ ns\ service\ style:\ rpc\n//gsoap\ ns\ service\ encoding:\ encoded\n//\ gsoap\ ns\ service\ style:\ document\n//\ gsoap\ ns\ service\ encoding:\ literal\n\nstruct\ t_mojaStruct2\ \{\n\tint\ a,\ b,\ c\;\ struct\ t_mojaStruct2\ *nast\;\n\}\;\n\nstruct\ ns__zwrocCos2Response\ \{\n\tstruct\ t_mojaStruct2\ *return_\;\n\}\;\n\nint\ ns__zwrocCos2(struct\ ns__zwrocCos2Response\ *r)\;\n\n\n\n\nW\ pliku\ q_serv:\n\n#include\ \"qqq.nsmap\"\n\nint\ main()\ \{\n\ \ struct\ soap\ soap\;\n\ \ soap_init(&soap)\;\n\n\ \ int\ b=soap_bind(&soap,\ NULL,\ 10000,\ 100)\;\ \n\ \ if(b<0)\ \{soap_print_fault(&soap,\ stderr)\;\ soap_done(&soap)\;\ exit(1)\;\}\n\n\ \ while\ (1)\ \{\n\ \ \ \ soap_accept(&soap)\;\ //\ czeka\ na\ soap\ msg\n\ \ \ \ soap_serve(&soap)\;\ //\ obsluga\ klienta\n\ \ \ \ soap_end(&soap)\;\ //\ zwalniani\ pamieci\n\ \ \ \ printf(\".\")\;\ fflush(stdout)\;\n\ \ \}\n\n\ \ return\ 0\;\n\}\n\nint\ ns__zwrocCos2(struct\ soap*\ soap,\ struct\ ns__zwrocCos2Response\ *r)\n\{\ \ \n\ \n\ \ r->return_\ =\ soap_malloc(\ soap,\ sizeof(\ struct\ t_mojaStruct2\ )\ )\;\n\n\ \ struct\ t_mojaStruct2*\ t2\ =\ soap_malloc(\ soap,\ sizeof(\ struct\ t_mojaStruct2\ )\ )\;\n\ \ struct\ t_mojaStruct2*\ t3\ =\ soap_malloc(\ soap,\ sizeof(\ struct\ t_mojaStruct2\ )\ )\;\n\t\n\ \ r->return_->nast\ =\ t2\;\n\ \ t2->nast\ =\ t3\;\n\ \ t3->nast\ =\ r->return_\;\n\n\ \ r->return_->a\ =\ 1\;\n\ \ r->return_->b\ =\ 2\;\n\ \ r->return_->c\ =\ 3\;\n\n\ \ t2->a\ =\ 4\;\n\ \ t2->b\ =\ 5\;\n\ \ t2->c\ =\ 6\;\n\n\ \ t3->a\ =\ 7\;\n\ \ t3->b\ =\ 8\;\n\ \ t3->c\ =\ 9\;\n\n\ \ return\ SOAP_OK\;\n\}\n\nk.java\ ->\ Klient\ w\ axis\n\nimport\ qqq_pkg.*\;\nimport\ java.util.*\;\n\n\n\npublic\ class\ k\n\{\n\ \ public\ static\ void\ main(String\ args\[\])\n\ \ \{\n\ \ \ \ \ try\ \{\n\t\t\tQqqLocator\ loc\ =\ new\ QqqLocator()\;\n\n\t\t\tQqqPortType\ obiekt\ =\ loc.getqqq()\;\n\t\t\t\n\t\t\tTMojaStruct2\ res\ =\ obiekt.zwrocCos2()\;\n\t\t\t\n\t\t\tTMojaStruct2\ next\ =\ res.getNast()\;\n\n\t\t\tSystem.out.printf(\ \"%d\ %d\ %d\\n\",\ res.getA(),res.getB(),res.getC()\ )\;\n\n\t\t\twhile(\ next\ !=\ res\ )\ \{\n\t\t\t\tSystem.out.printf(\ \"Element:\ %d\ %d\ %d\\n\",\ next.getA(),next.getB(),next.getC()\ )\;\n\t\t\t\tnext\ =\ next.getNast()\;\n\t\t\t\}\n\n\ \ \ \ \ \}\ catch\ (\ Exception\ e\ )\ \{\n\t\ System.err.print(\ \"error\"\ +\ e.getMessage()\ +\ \"\\n\"\ )\;\n\ \ \ \ \ \}\n\ \ \}\n\}\n\n\n\nWydruk\ z\ konsoli\ dla\ rpc/encoded:\n\nClient:\nagnieszka@X550L:~/Desktop/tas/D/Zad46\$\ java\ k\nElement:\ 1\ 2\ 3\ \ \ #\ pierwszy\ element\nElement:\ 4\ 5\ 6\ \ \ #\ drugi\ element\nElement:\ 7\ 8\ 9\ \ \ #\ trzeci\ element\n\nagnieszka@X550L:~/Desktop/tas/D/Zad46\$\ ./a.out\ \n.\n\nWydruk\ z\ konsoli\ dla\ document/literal:\n\nClient:\nagnieszka@X550L:~/Desktop/tas/D/Zad46_document\$\ java\ k\nerror(0)null\n\nServer:\nagnieszka@X550L:~/Desktop/tas/D/Zad46_document\$\ ./a.out\ \nSegmentation\ fault\ (core\ dumped)\n\n\nWniosek:\ Styl\ document/literal\ nie\ obs³uguje\ struktur\ dynamicznych.\n\n\n\n\n\n\n\n\n\n\nZADANIE\ D.1\n\nRó¿nice\ w\ stylu\ rpc\ i\ document:\n\nSOAP\ REQUEST:\n\nDocument:\n\n<?xml\ version=\"1.0\"\ encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope\n\ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\ xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n\ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\ xmlns:ns=\"qqq\">\n\ <SOAP-ENV:Body>\n\ \ <ns:razyMacierz>\n\ \ \ <ns:mat1\ SOAP-ENC:arrayType=\"xsd:int\[1\]\">\n\ \ \ \ <ns:item>0</ns:item>\n\ \ \ </ns:mat1>\n\ \ </ns:razyMacierz>\n\ </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n\nRPC:\n<?xml\ version=\"1.0\"\ encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope\n\ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\ xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n\ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\ xmlns:ns=\"qqq\">\n\ <SOAP-ENV:Body\ SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\n\ \ <ns:razyMacierz>\n\ \ \ <mat1\ SOAP-ENC:arrayType=\"xsd:int\[1\]\">\n\ \ \ \ <item>0</item>\n\ \ \ </mat1>\n\ \ </ns:razyMacierz>\n\ </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n\n\nG³ówn±\ ró¿nicê\ mo¿na\ znale¼æ\ w\ fakcie,\ ¿e\ w\ stylu\ encoded\ nazwy\ wszystkich\ parametrów\ wystêpuj±\ w\ namespace,\ a\ w\ RPC\ nie\ nale¿±\ do\ namespace.\nW\ WSDL\ struktura\ z\ parametrami\ zosta³a\ zdefiniowana\ jest\ w\ sekcji\ <types></types>.\ Powoduje\ to,\ ¿e\ s±\ one\ zawarte\ w\ namespace.\n\n<types>\n\n\ <schema\ targetNamespace=\"qqq\"\n\ \ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\ \ xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n\ \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\ \ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\ \ xmlns:ns=\"qqq\"\n\ \ xmlns=\"http://www.w3.org/2001/XMLSchema\"\n\ \ elementFormDefault=\"qualified\"\n\ \ attributeFormDefault=\"unqualified\">\n\ \ <import\ namespace=\"http://schemas.xmlsoap.org/soap/encoding/\"/>\n\ \ <complexType\ name=\"ArrayOfint\">\n\ \ \ <complexContent>\n\ \ \ \ <restriction\ base=\"SOAP-ENC:Array\">\n\ \ \ \ \ <sequence>\n\ \ \ \ \ \ <element\ name=\"item\"\ type=\"xsd:int\"\ minOccurs=\"0\"\ maxOccurs=\"unbounded\"/>\n\ \ \ \ \ </sequence>\n\ \ \ \ \ <attribute\ ref=\"SOAP-ENC:arrayType\"\ WSDL:arrayType=\"xsd:int\[\]\"/>\n\ \ \ \ </restriction>\n\ \ \ </complexContent>\n\ \ </complexType>\n\ \ <!--\ operation\ request\ element\ -->\n\ \ <element\ name=\"razyMacierz\">\n\ \ \ <complexType>\n\ \ \ \ <sequence>\n\ \ \ \ \ <element\ name=\"mat1\"\ type=\"ns:ArrayOfint\"\ minOccurs=\"1\"\ maxOccurs=\"1\"\ nillable=\"false\"/>\n\ \ \ \ </sequence>\n\ \ \ </complexType>\n\ \ </element>\n\ \ <!--\ operation\ response\ element\ -->\n\ \ <element\ name=\"razyMacierzResponse\">\n\ \ \ <complexType>\n\ \ \ \ <sequence>\n\ \ \ \ \ <element\ name=\"return\"\ type=\"ns:ArrayOfint\"\ minOccurs=\"0\"\ maxOccurs=\"1\"\ nillable=\"true\"/>\n\ \ \ \ </sequence>\n\ \ \ </complexType>\n\ \ </element>\n\ </schema>\n\n</types>\n\n<types>\n\ <schema\ targetNamespace=\"qqq\"\n\ \ xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\ \ xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n\ \ xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\ \ xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\ \ xmlns:ns=\"qqq\"\n\ \ xmlns=\"http://www.w3.org/2001/XMLSchema\"\n\ \ elementFormDefault=\"unqualified\"\n\ \ attributeFormDefault=\"unqualified\">\n\ \ <import\ namespace=\"http://schemas.xmlsoap.org/soap/encoding/\"/>\n\ \ <complexType\ name=\"ArrayOfint\">\n\ \ \ <complexContent>\n\ \ \ \ <restriction\ base=\"SOAP-ENC:Array\">\n\ \ \ \ \ <sequence>\n\ \ \ \ \ \ <element\ name=\"item\"\ type=\"xsd:int\"\ minOccurs=\"0\"\ maxOccurs=\"unbounded\"/>\n\ \ \ \ \ </sequence>\n\ \ \ \ \ <attribute\ ref=\"SOAP-ENC:arrayType\"\ WSDL:arrayType=\"xsd:int\[\]\"/>\n\ \ \ \ </restriction>\n\ \ \ </complexContent>\n\ \ </complexType>\n\ </schema>\n\n</types>\n\n
